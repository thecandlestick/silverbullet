{
  "name": "directive",
  "imports": [
    "https://get.silverbullet.md/global.plug.json"
  ],
  "functions": {
    "serverRenderDirective": {
      "code": "(() => { var mod=(()=>{var oe=Object.create;var A=Object.defineProperty;var se=Object.getOwnPropertyDescriptor;var ae=Object.getOwnPropertyNames;var ce=Object.getPrototypeOf,le=Object.prototype.hasOwnProperty;var w=(r=>typeof require!=\"undefined\"?require:typeof Proxy!=\"undefined\"?new Proxy(r,{get:(e,t)=>(typeof require!=\"undefined\"?require:e)[t]}):r)(function(r){if(typeof require!=\"undefined\")return require.apply(this,arguments);throw new Error('Dynamic require of \"'+r+'\" is not supported')});var L=(r,e)=>{for(var t in e)A(r,t,{get:e[t],enumerable:!0})},Q=(r,e,t,o)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let n of ae(e))!le.call(r,n)&&n!==t&&A(r,n,{get:()=>e[n],enumerable:!(o=se(e,n))||o.enumerable});return r};var T=(r,e,t)=>(t=r!=null?oe(ce(r)):{},Q(e||!r||!r.__esModule?A(t,\"default\",{value:r,enumerable:!0}):t,r)),ue=r=>Q(A({},\"__esModule\",{value:!0}),r);var Re={};L(Re,{default:()=>Fe});typeof self>\"u\"&&(self={syscall:()=>{throw new Error(\"Not implemented here\")}});var u=self.syscall;var g={};L(g,{parseMarkdown:()=>pe});function pe(r){return u(\"markdown.parseMarkdown\",r)}var Y=class{listPages(e=!1){return u(\"space.listPages\",e)}getPageMeta(e){return u(\"space.getPageMeta\",e)}readPage(e){return u(\"space.readPage\",e)}writePage(e,t){return u(\"space.writePage\",e,t)}deletePage(e){return u(\"space.deletePage\",e)}listPlugs(){return u(\"space.listPlugs\")}listAttachments(){return u(\"space.listAttachments\")}getAttachmentMeta(e){return u(\"space.getAttachmentMeta\",e)}readAttachment(e){return u(\"space.readAttachment\",e)}writeAttachment(e,t,o){return u(\"space.writeAttachment\",e,t,o)}deleteAttachment(e){return u(\"space.deleteAttachment\",e)}readFile(e,t){return u(\"space.readFile\",e,t)}getFileMeta(e){return u(\"space.getFileMeta\",e)}writeFile(e,t,o){return u(\"space.writeFile\",e,t,o)}deleteFile(e){return u(\"space.deleteFile\",e)}listFiles(e){return u(\"space.listFiles\",e)}},y=new Y;function q(r){if(!!r.children)for(let e of r.children){if(e.parent)return;e.parent=r,q(e)}}function M(r,e){return N(r,t=>t.type===e)}function N(r,e){if(e(r))return[r];let t=[];if(r.children)for(let o of r.children)t=[...t,...N(o,e)];return t}function b(r,e){if(r.children){let t=r.children.slice();for(let o of t){let n=e(o);if(n!==void 0){let i=r.children.indexOf(o);n?r.children.splice(i,1,n):r.children.splice(i,1)}else b(o,e)}}}function p(r,e){return N(r,t=>t.type===e)[0]}function $(r,e){N(r,e)}function d(r){let e=[];if(r.text!==void 0)return r.text;for(let t of r.children)e.push(d(t));return e.join(\"\")}var H=T(w(\"https://deno.land/std@0.184.0/yaml/mod.ts\"));var v=T(w(\"https://esm.sh/handlebars\")),I=T(w(\"https://deno.land/std@0.184.0/yaml/mod.ts\"));function x(r){function e(t){let o=String(t);return o.length===1&&(o=\"0\"+o),o}return r.getFullYear()+\"-\"+e(r.getMonth()+1)+\"-\"+e(r.getDate())}var _=70;function xe(r,e){return e===void 0?\"\":\"\"+e}function k(r,e=xe){let t=new Map;for(let s of r)for(let a of Object.keys(s)){let c=t.get(a);c?c=Math.max(e(a,s[a]).length,c):c=e(a,s[a]).length,t.set(a,c)}let o=0;for(let s of t.values())o+=s+1;let n=[...t.keys()],i=[];i.push(\"|\"+n.map(s=>s+l(\" \",t.get(s)-s.length)).join(\"|\")+\"|\"),i.push(\"|\"+n.map(s=>l(\"-\",t.get(s))).join(\"|\")+\"|\");for(let s of r){let a=[];for(let c of n){let m=e(c,s[c]);a.push(m+l(\" \",t.get(c)-m.length))}i.push(\"|\"+a.join(\"|\")+\"|\")}return i.join(`\n`);function l(s,a){return o>_&&s===\"\"?\"\":o>_&&s===\"-\"?\"--\":a<1?\"\":new Array(a+1).join(s)}}async function F(r,e){v.default.registerHelper(\"json\",n=>JSON.stringify(n)),v.default.registerHelper(\"niceDate\",n=>x(new Date(n))),v.default.registerHelper(\"prefixLines\",(n,i)=>n.split(`\n`).map(l=>i+l).join(`\n`)),v.default.registerHelper(\"substring\",(n,i,l,s=\"\")=>n.length>l-i?n.substring(i,l)+s:n),v.default.registerHelper(\"yaml\",(n,i)=>{if(typeof i==\"string\"){let l=I.stringify(n).split(`\n`).join(`\n`+i).trim();return Array.isArray(n)?`\n`+i+l:l}else return I.stringify(n).trim()});let t=await y.readPage(r);return t=`{{#each .}}\n${t}\n{{/each}}`,v.default.compile(t,{noEscape:!0})(e)}function Pe(r){return r.replaceAll(/(\\w+\\.\\w+)\\s*\\(/g,'await invokeFunction(\"$1\", ')}var he=/(.+?)(\\s+render\\s+\\[\\[([^\\]]+)\\]\\])?$/;async function J(r,e,t){if(typeof t!=\"string\")throw new Error(\"Expected a string\");console.log(\"Got JS expression\",t);let o=he.exec(t);if(!o)throw new Error(`Invalid eval directive: ${t}`);let n=\"\";o[3]&&(t=o[1],n=o[3]);try{let i=await(0,eval)(`(async () => { \n        function invokeFunction(name, ...args) {\n          return syscall(\"system.invokeFunction\", \"server\", name, ...args);\n        }\n        return ${Pe(t)};\n      })()`);return n?await F(n,i):typeof i==\"string\"?i:typeof i==\"number\"?\"\"+i:Array.isArray(i)?k(i):H.stringify(i)}catch(i){return`**ERROR:** ${i.message}`}}var P=self.syscall;var R={};L(R,{dispatchEvent:()=>Te,listEvents:()=>ve});function Te(r,e,t){return new Promise((o,n)=>{let i=-1;t&&(i=setTimeout(()=>{console.log(\"Timeout!\"),n(\"timeout\")},t)),P(\"event.dispatch\",r,e).then(l=>{i!==-1&&clearTimeout(i),o(l)}).catch(n)})}function ve(){return P(\"event.list\")}var D=T(w(\"https://deno.land/std@0.184.0/yaml/mod.ts\"));function E(r,e=[]){let t={};return q(r),b(r,o=>{if(o.type===\"Hashtag\"){if(o.parent&&o.parent.type===\"Paragraph\"){let c=o.children[0].text.substring(1);t.tags||(t.tags=[]),Array.isArray(t.tags)&&!t.tags.includes(c)&&t.tags.push(c)}return}if(o.type===\"FrontMatter\"){let c=o.children[1].children[0],m=d(c);try{let f=D.parse(m),h={...f};if(t={...t,...f},e.length>0){let j=!1;for(let W of e)W in h&&(delete h[W],j=!0);j&&(c.text=D.stringify(h))}if(Object.keys(h).length===0)return null}catch(f){console.error(\"Could not parse frontmatter\",f)}}if(o.type!==\"FencedCode\")return;let n=p(o,\"CodeInfo\");if(!n||n.children[0].text!==\"meta\")return;let i=p(o,\"CodeText\");if(!i)return;let l=i.children[0].text,s=D.parse(l),a={...s};if(t={...t,...s},e.length>0){let c=!1;for(let m of e)m in a&&(delete a[m],c=!0);c&&(i.children[0].text=D.stringify(a).trim())}if(Object.keys(a).length===0)return null}),t.name&&(t.displayName=t.name,delete t.name),t}var G=T(w(\"https://deno.land/std@0.184.0/yaml/mod.ts\"));async function K(r,e,t){let o=[];r.replace(e,(i,...l)=>{let s=t(i,...l);return o.push(s),\"\"});let n=await Promise.all(o);return r.replace(e,()=>n.shift())}var Se=T(w(\"https://deno.land/std@0.184.0/yaml/mod.ts\"));function C(r,e){return r.replaceAll(/\\{\\{([^\\}]+)\\}\\}/g,(t,o)=>{switch(o){case\"today\":return x(new Date);case\"tomorrow\":{let n=new Date;return n.setDate(n.getDate()+1),x(n)}case\"yesterday\":{let n=new Date;return n.setDate(n.getDate()-1),x(n)}case\"lastWeek\":{let n=new Date;return n.setDate(n.getDate()-7),x(n)}case\"nextWeek\":{let n=new Date;return n.setDate(n.getDate()+7),x(n)}case\"page\":return e}return t})}function z(r){b(r,a=>{if(!a.type){let c=a.text.trim();if(!c)return null;a.text=c}});let e=r.children[0],t={table:e.children[0].children[0].text,filter:[],ordering:[]},o=M(e,\"OrderClause\");for(let a of o){let m=p(a,\"Name\").children[0].text,f=p(a,\"OrderDirection\"),h=f?f.children[0].text===\"desc\":!1;t.ordering.push({orderBy:m,orderDesc:h})}t.ordering.length>0&&(t.orderBy=t.ordering[0].orderBy,t.orderDesc=t.ordering[0].orderDesc);let n=p(e,\"LimitClause\");if(n){let a=p(n,\"Number\");t.limit=O(a)}let i=M(e,\"FilterExpr\");for(let a of i){let c,m=a.children[2].children[0];c=O(m);let f={prop:a.children[0].children[0].text,op:a.children[1].text,value:c};t.filter.push(f)}let l=p(e,\"SelectClause\");l&&(t.select=[],M(l,\"Name\").forEach(a=>{t.select.push(a.children[0].text)}));let s=p(e,\"RenderClause\");if(s){let a=p(s,\"PageRef\");a||(a=p(s,\"String\")),t.render=O(a)}return t}function O(r){switch(r.type){case\"Number\":return+r.children[0].text;case\"Bool\":return r.children[0].text===\"true\";case\"Null\":return null;case\"Name\":return r.children[0].text;case\"Regex\":{let e=r.children[0].text;return e.substring(1,e.length-1)}case\"String\":{let e=r.children[0].text;return e.substring(1,e.length-1)}case\"PageRef\":{let e=r.children[0].text;return e.substring(2,e.length-2)}case\"List\":return M(r,\"Value\").map(e=>O(e.children[0]))}}async function X(r,e,t){if(typeof t==\"string\")throw new Error(\"Argument must be a ParseTree\");let o=z(JSON.parse(C(JSON.stringify(t),e))),n=`query:${o.table}`,i=await R.dispatchEvent(n,{query:o,pageName:e},30*1e3);if(i.length===0)return`**Error:** Unsupported query source '${o.table}'`;if(i.length===1)return o.render?(await F(o.render,i[0])).trim():i[0].length===0?\"No results\":k(i[0]);throw new Error(`Too many query results: ${i.length}`)}var Z=/(<!--\\s*#query\\s+(.+?)-->)(.+?)(<!--\\s*\\/query\\s*-->)/gs;var ee=T(w(\"https://esm.sh/handlebars\"));var Ne=/\\[\\[([^\\]]+)\\]\\]\\s*(.*)\\s*/;async function B(r,e,t){if(typeof t!=\"string\")throw new Error(\"Template directives must be a string\");let o=t.match(Ne);if(!o)throw new Error(`Invalid template directive: ${t}`);let n=o[1],i=o[2],l={};if(i)try{l=JSON.parse(i)}catch{throw new Error(`Failed to parse template instantiation args: ${t}`)}let s=\"\";if(n.startsWith(\"http://\")||n.startsWith(\"https://\"))try{s=await(await fetch(n)).text()}catch(c){s=`ERROR: ${c.message}`}else s=await y.readPage(n);let a=s;if(r===\"use\"){let c=await g.parseMarkdown(s);E(c,[\"$disableDirectives\"]),s=d(c),a=ee.default.compile(C(s,e),{noEscape:!0})(l),a=await ne(e,a)}return a.trim()}function te(r){return K(r,re,(e,t,o,n,i,l)=>(o===\"use\"&&(i=i.replaceAll(Z,(s,a,c,m)=>m.trim())),Promise.resolve(`${t}${i}${l}`)))}var $e=/<!--\\s*#(use|use-verbose|include|eval|query)\\s+(.*?)-->/i,re=/(<!--\\s*#(use|use-verbose|include|eval|query)\\s+(.*?)-->)(.+?)(<!--\\s*\\/\\2\\s*-->)/gs;async function ke(r,e,t){let o=e.children[0],n=e.children[2],i=d(o).trim(),l=d(n).trim();if(o.children.length===1){let s=$e.exec(o.children[0].text);if(!s)throw Error(\"No match\");let[a,c,m]=s;try{m=m.trim();let f=await t[c](c,r,m);return`${i}\n${f.trim()}\n${l}`}catch(f){return`${i}\n**ERROR:** ${f.message}\n${l}`}}else{let s=await t.query(\"query\",r,o.children[1]);return`${i}\n${s.trim()}\n${l}`}}async function U(r,e){let t=await ke(r,e,{use:B,include:B,query:X,eval:J});return te(t)}function ie(r,e){return U(r,e)}async function ne(r,e){let t=await g.parseMarkdown(e),o=[],n=[];$(t,i=>{if(i.type!==\"Directive\")return!1;let l=e.substring(i.from,i.to);try{let s=U(r,i);o.push({textPromise:s,fullMatch:l}),n.push(s)}catch(s){o.push({fullMatch:l,textPromise:Promise.resolve(`${d(i.children[0])}\n**ERROR:** ${s.message}\n${d(i.children[i.children.length-1])}`)})}return!0}),await Promise.all(n);for(let i of o)e=e.replace(i.fullMatch,await i.textPromise);return e}var Fe=ie;return ue(Re);})();\n return mod;})()"
    },
    "updateDirectivesOnPageCommand": {
      "command": {
        "name": "Directives: Update",
        "key": "Alt-q"
      },
      "events": [
        "editor:pageLoaded"
      ],
      "code": "(() => { var mod=(()=>{var I=Object.create;var M=Object.defineProperty;var B=Object.getOwnPropertyDescriptor;var U=Object.getOwnPropertyNames;var j=Object.getPrototypeOf,W=Object.prototype.hasOwnProperty;var d=(e=>typeof require!=\"undefined\"?require:typeof Proxy!=\"undefined\"?new Proxy(e,{get:(t,r)=>(typeof require!=\"undefined\"?require:t)[r]}):e)(function(e){if(typeof require!=\"undefined\")return require.apply(this,arguments);throw new Error('Dynamic require of \"'+e+'\" is not supported')});var A=(e,t)=>{for(var r in t)M(e,r,{get:t[r],enumerable:!0})},O=(e,t,r,i)=>{if(t&&typeof t==\"object\"||typeof t==\"function\")for(let s of U(t))!W.call(e,s)&&s!==r&&M(e,s,{get:()=>t[s],enumerable:!(i=B(t,s))||i.enumerable});return e};var g=(e,t,r)=>(r=e!=null?I(j(e)):{},O(t||!e||!e.__esModule?M(r,\"default\",{value:e,enumerable:!0}):r,e)),Q=e=>O(M({},\"__esModule\",{value:!0}),e);var je={};A(je,{default:()=>Ue});typeof self>\"u\"&&(self={syscall:()=>{throw new Error(\"Not implemented here\")}});var n=self.syscall;var u={};A(u,{confirm:()=>pe,dispatch:()=>me,downloadFile:()=>re,filterBox:()=>ie,flashNotification:()=>ne,getCurrentPage:()=>_,getCursor:()=>G,getSelection:()=>K,getText:()=>J,getUiOption:()=>de,hidePanel:()=>se,insertAtCursor:()=>ue,insertAtPos:()=>ae,moveCursor:()=>le,navigate:()=>Z,openUrl:()=>te,prompt:()=>fe,reloadPage:()=>ee,replaceRange:()=>ce,save:()=>X,setPage:()=>H,setSelection:()=>z,setUiOption:()=>ge,showPanel:()=>oe,vimEx:()=>ye});function _(){return n(\"editor.getCurrentPage\")}function H(e){return n(\"editor.setPage\",e)}function J(){return n(\"editor.getText\")}function G(){return n(\"editor.getCursor\")}function K(){return n(\"editor.getSelection\")}function z(e,t){return n(\"editor.setSelection\",e,t)}function X(){return n(\"editor.save\")}function Z(e,t,r=!1,i=!1){return n(\"editor.navigate\",e,t,r,i)}function ee(){return n(\"editor.reloadPage\")}function te(e){return n(\"editor.openUrl\",e)}function re(e,t){return n(\"editor.downloadFile\",e,t)}function ne(e,t=\"info\"){return n(\"editor.flashNotification\",e,t)}function ie(e,t,r=\"\",i=\"\"){return n(\"editor.filterBox\",e,t,r,i)}function oe(e,t,r,i=\"\"){return n(\"editor.showPanel\",e,t,r,i)}function se(e){return n(\"editor.hidePanel\",e)}function ae(e,t){return n(\"editor.insertAtPos\",e,t)}function ce(e,t,r){return n(\"editor.replaceRange\",e,t,r)}function le(e,t=!1){return n(\"editor.moveCursor\",e,t)}function ue(e){return n(\"editor.insertAtCursor\",e)}function me(e){return n(\"editor.dispatch\",e)}function fe(e,t=\"\"){return n(\"editor.prompt\",e,t)}function pe(e){return n(\"editor.confirm\",e)}function de(e){return n(\"editor.getUiOption\",e)}function ge(e,t){return n(\"editor.setUiOption\",e,t)}function ye(e){return n(\"editor.vimEx\",e)}var y={};A(y,{parseMarkdown:()=>Pe});function Pe(e){return n(\"markdown.parseMarkdown\",e)}var k=class{listPages(t=!1){return n(\"space.listPages\",t)}getPageMeta(t){return n(\"space.getPageMeta\",t)}readPage(t){return n(\"space.readPage\",t)}writePage(t,r){return n(\"space.writePage\",t,r)}deletePage(t){return n(\"space.deletePage\",t)}listPlugs(){return n(\"space.listPlugs\")}listAttachments(){return n(\"space.listAttachments\")}getAttachmentMeta(t){return n(\"space.getAttachmentMeta\",t)}readAttachment(t){return n(\"space.readAttachment\",t)}writeAttachment(t,r,i){return n(\"space.writeAttachment\",t,r,i)}deleteAttachment(t){return n(\"space.deleteAttachment\",t)}readFile(t,r){return n(\"space.readFile\",t,r)}getFileMeta(t){return n(\"space.getFileMeta\",t)}writeFile(t,r,i){return n(\"space.writeFile\",t,r,i)}deleteFile(t){return n(\"space.deleteFile\",t)}listFiles(t){return n(\"space.listFiles\",t)}},x=new k;var S={};A(S,{getEnv:()=>De,invokeCommand:()=>Te,invokeFunction:()=>we,listCommands:()=>ve,reloadPlugs:()=>be});function we(e,t,...r){return n(\"system.invokeFunction\",e,t,...r)}function Te(e){return n(\"system.invokeCommand\",e)}function ve(){return n(\"system.listCommands\")}function be(){n(\"system.reloadPlugs\")}function De(){return n(\"system.getEnv\")}function F(e){if(!!e.children)for(let t of e.children){if(t.parent)return;t.parent=e,F(t)}}function R(e){if(delete e.parent,!!e.children)for(let t of e.children)R(t)}function E(e,t){if(t(e))return[e];let r=[];if(e.children)for(let i of e.children)r=[...r,...E(i,t)];return r}function b(e,t){if(e.children){let r=e.children.slice();for(let i of r){let s=t(i);if(s!==void 0){let l=e.children.indexOf(i);s?e.children.splice(l,1,s):e.children.splice(l,1)}else b(i,t)}}}function D(e,t){return E(e,r=>r.type===t)[0]}function N(e,t){E(e,t)}function m(e){let t=[];if(e.text!==void 0)return e.text;for(let r of e.children)t.push(m(r));return t.join(\"\")}var Re=g(d(\"https://deno.land/std@0.184.0/yaml/mod.ts\"));var Ne=g(d(\"https://esm.sh/handlebars\")),$e=g(d(\"https://deno.land/std@0.184.0/yaml/mod.ts\"));var P=self.syscall;var h=g(d(\"https://deno.land/std@0.184.0/yaml/mod.ts\"));function $(e,t=[]){let r={};return F(e),b(e,i=>{if(i.type===\"Hashtag\"){if(i.parent&&i.parent.type===\"Paragraph\"){let a=i.children[0].text.substring(1);r.tags||(r.tags=[]),Array.isArray(r.tags)&&!r.tags.includes(a)&&r.tags.push(a)}return}if(i.type===\"FrontMatter\"){let a=i.children[1].children[0],c=m(a);try{let f=h.parse(c),p={...f};if(r={...r,...f},t.length>0){let v=!1;for(let C of t)C in p&&(delete p[C],v=!0);v&&(a.text=h.stringify(p))}if(Object.keys(p).length===0)return null}catch(f){console.error(\"Could not parse frontmatter\",f)}}if(i.type!==\"FencedCode\")return;let s=D(i,\"CodeInfo\");if(!s||s.children[0].text!==\"meta\")return;let l=D(i,\"CodeText\");if(!l)return;let w=l.children[0].text,T=h.parse(w),o={...T};if(r={...r,...T},t.length>0){let a=!1;for(let c of t)c in o&&(delete o[c],a=!0);a&&(l.children[0].text=h.stringify(o).trim())}if(Object.keys(o).length===0)return null}),r.name&&(r.displayName=r.name,delete r.name),r}var Y=g(d(\"https://deno.land/std@0.184.0/yaml/mod.ts\"));var qe=g(d(\"https://deno.land/std@0.184.0/yaml/mod.ts\"));var Be=g(d(\"https://esm.sh/handlebars\"));async function q(e){let t=typeof e!=\"string\",r=await u.getCurrentPage(),i=await u.getText(),s=await y.parseMarkdown(i),l=$(s,[\"$disableDirectives\"]);if(l.$disableDirectives)return;if(l.$share){for(let o of l.$share)if(o.startsWith(\"collab:\")){t&&await u.flashNotification(\"Directives are disabled for 'collab' pages (safety reasons).\",\"error\");return}}let w=[],T=[];R(s),N(s,o=>{if(o.type!==\"Directive\")return!1;let a=i.substring(o.from,o.to);try{let c=S.invokeFunction(\"server\",\"serverRenderDirective\",r,o);w.push({textPromise:c,fullMatch:a}),T.push(c)}catch(c){w.push({fullMatch:a,textPromise:Promise.resolve(`${m(o.children[0])}\n**ERROR:** ${c.message}\n${m(o.children[o.children.length-1])}`)})}return!0}),await Promise.all(T);for(let o of w){let a=await u.getText(),c=a.indexOf(o.fullMatch);if(c===-1){console.warn(\"Text I got\",a),console.warn(\"Could not find directive in text, skipping\",o.fullMatch);continue}let f=c,p=c+o.fullMatch.length,v=await o.textPromise;a.substring(f,p)!==v&&await u.dispatch({changes:{from:f,to:p,insert:v}})}}var Ue=q;return Q(je);})();\n return mod;})()"
    },
    "indexData": {
      "events": [
        "page:index"
      ],
      "code": "(() => { var mod=(()=>{var w=Object.create;var u=Object.defineProperty;var F=Object.getOwnPropertyDescriptor;var k=Object.getOwnPropertyNames;var S=Object.getPrototypeOf,M=Object.prototype.hasOwnProperty;var E=(r=>typeof require!=\"undefined\"?require:typeof Proxy!=\"undefined\"?new Proxy(r,{get:(e,t)=>(typeof require!=\"undefined\"?require:e)[t]}):r)(function(r){if(typeof require!=\"undefined\")return require.apply(this,arguments);throw new Error('Dynamic require of \"'+r+'\" is not supported')});var y=(r,e)=>{for(var t in e)u(r,t,{get:e[t],enumerable:!0})},h=(r,e,t,o)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let i of k(e))!M.call(r,i)&&i!==t&&u(r,i,{get:()=>e[i],enumerable:!(o=F(e,i))||o.enumerable});return r};var C=(r,e,t)=>(t=r!=null?w(S(r)):{},h(e||!r||!r.__esModule?u(t,\"default\",{value:r,enumerable:!0}):t,r)),O=r=>h(u({},\"__esModule\",{value:!0}),r);var J={};y(J,{default:()=>H});typeof self>\"u\"&&(self={syscall:()=>{throw new Error(\"Not implemented here\")}});var n=self.syscall;var l={};y(l,{batchSet:()=>q,clearPageIndex:()=>j,clearPageIndexForPage:()=>B,del:()=>Q,deletePrefixForPage:()=>$,get:()=>D,query:()=>U,queryPrefix:()=>L,set:()=>R});function R(r,e,t){return n(\"index.set\",r,e,t)}function q(r,e){return n(\"index.batchSet\",r,e)}function D(r,e){return n(\"index.get\",r,e)}function Q(r,e){return n(\"index.delete\",r,e)}function L(r){return n(\"index.queryPrefix\",r)}function U(r){return n(\"index.query\",r)}function B(r){return n(\"index.clearPageIndexForPage\",r)}function $(r,e){return n(\"index.deletePrefixForPage\",r,e)}function j(){return n(\"index.clearPageIndex\")}var d=class{listPages(e=!1){return n(\"space.listPages\",e)}getPageMeta(e){return n(\"space.getPageMeta\",e)}readPage(e){return n(\"space.readPage\",e)}writePage(e,t){return n(\"space.writePage\",e,t)}deletePage(e){return n(\"space.deletePage\",e)}listPlugs(){return n(\"space.listPlugs\")}listAttachments(){return n(\"space.listAttachments\")}getAttachmentMeta(e){return n(\"space.getAttachmentMeta\",e)}readAttachment(e){return n(\"space.readAttachment\",e)}writeAttachment(e,t,o){return n(\"space.writeAttachment\",e,t,o)}deleteAttachment(e){return n(\"space.deleteAttachment\",e)}readFile(e,t){return n(\"space.readFile\",e,t)}getFileMeta(e){return n(\"space.getFileMeta\",e)}writeFile(e,t,o){return n(\"space.writeFile\",e,t,o)}deleteFile(e){return n(\"space.deleteFile\",e)}listFiles(e){return n(\"space.listFiles\",e)}},Y=new d;function v(r,e){return f(r,t=>t.type===e)}function f(r,e){if(e(r))return[r];let t=[];if(r.children)for(let o of r.children)t=[...t,...f(o,e)];return t}function p(r,e){if(r.children){let t=r.children.slice();for(let o of t){let i=e(o);if(i!==void 0){let a=r.children.indexOf(o);i?r.children.splice(a,1,i):r.children.splice(a,1)}else p(o,e)}}}function m(r,e){return f(r,t=>t.type===e)[0]}function g(r){let e=[];if(r.text!==void 0)return r.text;for(let t of r.children)e.push(g(t));return e.join(\"\")}function T(r){p(r,e=>{if(e.type!==\"Directive\")return;let t=g(e);return{from:e.from,to:e.to,text:new Array(t.length+1).join(\" \")}})}var b=C(E(\"https://deno.land/std@0.184.0/yaml/mod.ts\"));async function A({name:r,tree:e}){let t=[];T(e),v(e,\"FencedCode\").forEach(o=>{let i=m(o,\"CodeInfo\");if(!i||i.children[0].text!==\"data\")return;let a=m(o,\"CodeText\");if(!a)return;let P=a.children[0].text;try{let c=P.split(\"---\").map(s=>b.parse(s));for(let s=0;s<c.length;s++){let x=c[s];!x||t.push({key:`data:${r}@${o.from+s}`,value:x})}}catch(c){console.error(\"Could not parse data\",P,\"error:\",c);return}}),await l.batchSet(r,t)}var H=A;return O(J);})();\n return mod;})()"
    },
    "dataQueryProvider": {
      "events": [
        "query:data"
      ],
      "code": "(() => { var mod=(()=>{var y=Object.create;var l=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var v=Object.getOwnPropertyNames;var T=Object.getPrototypeOf,b=Object.prototype.hasOwnProperty;var A=(r=>typeof require!=\"undefined\"?require:typeof Proxy!=\"undefined\"?new Proxy(r,{get:(e,n)=>(typeof require!=\"undefined\"?require:e)[n]}):r)(function(r){if(typeof require!=\"undefined\")return require.apply(this,arguments);throw new Error('Dynamic require of \"'+r+'\" is not supported')});var p=(r,e)=>{for(var n in e)l(r,n,{get:e[n],enumerable:!0})},m=(r,e,n,i)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let o of v(e))!b.call(r,o)&&o!==n&&l(r,o,{get:()=>e[o],enumerable:!(i=h(e,o))||i.enumerable});return r};var w=(r,e,n)=>(n=r!=null?y(T(r)):{},m(e||!r||!r.__esModule?l(n,\"default\",{value:r,enumerable:!0}):n,r)),F=r=>m(l({},\"__esModule\",{value:!0}),r);var Y={};p(Y,{default:()=>K});typeof self>\"u\"&&(self={syscall:()=>{throw new Error(\"Not implemented here\")}});var t=self.syscall;var d={};p(d,{batchSet:()=>E,clearPageIndex:()=>D,clearPageIndexForPage:()=>R,del:()=>O,deletePrefixForPage:()=>q,get:()=>C,query:()=>N,queryPrefix:()=>I,set:()=>M});function M(r,e,n){return t(\"index.set\",r,e,n)}function E(r,e){return t(\"index.batchSet\",r,e)}function C(r,e){return t(\"index.get\",r,e)}function O(r,e){return t(\"index.delete\",r,e)}function I(r){return t(\"index.queryPrefix\",r)}function N(r){return t(\"index.query\",r)}function R(r){return t(\"index.clearPageIndexForPage\",r)}function q(r,e){return t(\"index.deletePrefixForPage\",r,e)}function D(){return t(\"index.clearPageIndex\")}var f=class{listPages(e=!1){return t(\"space.listPages\",e)}getPageMeta(e){return t(\"space.getPageMeta\",e)}readPage(e){return t(\"space.readPage\",e)}writePage(e,n){return t(\"space.writePage\",e,n)}deletePage(e){return t(\"space.deletePage\",e)}listPlugs(){return t(\"space.listPlugs\")}listAttachments(){return t(\"space.listAttachments\")}getAttachmentMeta(e){return t(\"space.getAttachmentMeta\",e)}readAttachment(e){return t(\"space.readAttachment\",e)}writeAttachment(e,n,i){return t(\"space.writeAttachment\",e,n,i)}deleteAttachment(e){return t(\"space.deleteAttachment\",e)}readFile(e,n){return t(\"space.readFile\",e,n)}getFileMeta(e){return t(\"space.getFileMeta\",e)}writeFile(e,n,i){return t(\"space.writeFile\",e,n,i)}deleteFile(e){return t(\"space.deleteFile\",e)}listFiles(e){return t(\"space.listFiles\",e)}},U=new f;function g(r,e){let n=[];if(r.filter.length===0)n=e.slice();else{e:for(let i of e){let o=i;for(let{op:s,prop:c,value:a}of r.filter)switch(s){case\"=\":{let u=o[c];if(Array.isArray(u)&&!Array.isArray(a)){if(!u.includes(a))continue e}else if(Array.isArray(u)&&Array.isArray(a)){if(!u.some(x=>a.includes(x)))continue e}else if(u!=a)continue e;break}case\"!=\":if(o[c]==a)continue e;break;case\"<\":if(!(o[c]<a))continue e;break;case\"<=\":if(!(o[c]<=a))continue e;break;case\">\":if(!(o[c]>a))continue e;break;case\">=\":if(!(o[c]>=a))continue e;break;case\"=~\":if(!new RegExp(a).exec(o[c]))continue e;break;case\"!=~\":if(new RegExp(a).exec(o[c]))continue e;break;case\"in\":if(!a.includes(o[c]))continue e;break}n.push(o)}}return r.ordering.length>0&&(n=n.sort((i,o)=>{for(let{orderBy:s,orderDesc:c}of r.ordering){if(i[s]<o[s]||i[s]===void 0)return c?1:-1;if(i[s]>o[s]||o[s]===void 0)return c?-1:1}return 0})),r.limit&&(n=n.slice(0,r.limit)),r.select&&(n=n.map(i=>{let o={};for(let s of r.select)o[s]=i[s];return o})),n}var V=w(A(\"https://deno.land/std@0.184.0/yaml/mod.ts\"));async function P({query:r}){let e=[];for(let{key:n,page:i,value:o}of await d.queryPrefix(\"data:\")){let[,s]=n.split(\"@\");e.push({...o,page:i,pos:+s})}return g(r,e)}var K=P;return F(Y);})();\n return mod;})()"
    },
    "queryComplete": {
      "events": [
        "editor:complete"
      ],
      "code": "(() => { var mod=(()=>{var a=Object.defineProperty;var f=Object.getOwnPropertyDescriptor;var p=Object.getOwnPropertyNames;var g=Object.prototype.hasOwnProperty;var u=(e,t)=>{for(var r in t)a(e,r,{get:t[r],enumerable:!0})},x=(e,t,r,o)=>{if(t&&typeof t==\"object\"||typeof t==\"function\")for(let s of p(t))!g.call(e,s)&&s!==r&&a(e,s,{get:()=>t[s],enumerable:!(o=f(t,s))||o.enumerable});return e};var y=e=>x(a({},\"__esModule\",{value:!0}),e);var w={};u(w,{default:()=>$});var n=self.syscall;var i={};u(i,{dispatchEvent:()=>h,listEvents:()=>b});function h(e,t,r){return new Promise((o,s)=>{let l=-1;r&&(l=setTimeout(()=>{console.log(\"Timeout!\"),s(\"timeout\")},r)),n(\"event.dispatch\",e,t).then(c=>{l!==-1&&clearTimeout(l),o(c)}).catch(s)})}function b(){return n(\"event.list\")}async function m(e){let t=/#query ([\\w\\-_]+)*$/.exec(e.linePrefix);if(!t)return null;let r=await i.listEvents();return{from:e.pos-t[1].length,options:r.filter(o=>o.startsWith(\"query:\")).map(o=>({label:o.substring(6)}))}}var $=m;return y(w);})();\n return mod;})()"
    },
    "insertQuery": {
      "redirect": "core.insertTemplateText",
      "slashCommand": {
        "name": "query",
        "description": "Insert a query",
        "value": "<!-- #query |^| -->\n\n<!-- /query -->\n"
      }
    },
    "insertInclude": {
      "redirect": "core.insertTemplateText",
      "slashCommand": {
        "name": "include",
        "description": "Include another page",
        "value": "<!-- #include [[|^|]] -->\n\n<!-- /include -->\n"
      }
    },
    "insertUseTemplate": {
      "redirect": "core.insertTemplateText",
      "slashCommand": {
        "name": "use",
        "description": "Use a template",
        "value": "<!-- #use [[|^|]] {} -->\n\n<!-- /use -->\n"
      }
    },
    "insertUseVerboseTemplate": {
      "redirect": "core.insertTemplateText",
      "slashCommand": {
        "name": "use-verbose",
        "description": "Use a template (verbose mode)",
        "value": "<!-- #use-verbose [[|^|]] {} -->\n\n<!-- /use-verbose -->\n"
      }
    },
    "insertEvalTemplate": {
      "redirect": "core.insertTemplateText",
      "slashCommand": {
        "name": "eval",
        "description": "Evaluate a JavaScript expression",
        "value": "<!-- #eval |^| -->\n\n<!-- /eval -->\n"
      }
    }
  },
  "assets": {}
}