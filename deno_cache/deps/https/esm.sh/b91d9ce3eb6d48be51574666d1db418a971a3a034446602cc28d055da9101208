/* esm.sh - esbuild bundle(yjs@13.5.42) deno production */
var __global$ = globalThis || (typeof window !== "undefined" ? window : self);import{Observable as le}from"/v119/lib0@0.2.74/deno/observable.js";import*as v from"/v119/lib0@0.2.74/deno/array.js";import*as A from"/v119/lib0@0.2.74/deno/math.js";import*as I from"/v119/lib0@0.2.74/deno/map.js";import*as f from"/v119/lib0@0.2.74/deno/encoding.js";import*as p from"/v119/lib0@0.2.74/deno/decoding.js";import*as Kt from"/v119/lib0@0.2.74/deno/random.js";import*as ve from"/v119/lib0@0.2.74/deno/promise.js";import*as Ne from"/v119/lib0@0.2.74/deno/buffer.js";import*as C from"/v119/lib0@0.2.74/deno/error.js";import*as k from"/v119/lib0@0.2.74/deno/binary.js";import*as Be from"/v119/lib0@0.2.74/deno/function.js";import{callAll as Dn}from"/v119/lib0@0.2.74/deno/function.js";import*as kt from"/v119/lib0@0.2.74/deno/set.js";import*as L from"/v119/lib0@0.2.74/deno/logging.js";import*as Fe from"/v119/lib0@0.2.74/deno/time.js";import*as ht from"/v119/lib0@0.2.74/deno/iterator.js";import*as Je from"/v119/lib0@0.2.74/deno/object.js";var ye=class extends le{constructor(t,e){super(),this.doc=t,this.awareness=e}},yt=class{constructor(t,e){this.clock=t,this.len=e}},Z=class{constructor(){this.clients=new Map}},rt=(r,t,e)=>t.clients.forEach((n,i)=>{let s=r.doc.store.clients.get(i);for(let l=0;l<n.length;l++){let o=n[l];Ze(r,s,o.clock,o.len,e)}}),Un=(r,t)=>{let e=0,n=r.length-1;for(;e<=n;){let i=A.floor((e+n)/2),s=r[i],l=s.clock;if(l<=t){if(t<l+s.len)return i;e=i+1}else n=i-1}return null},At=(r,t)=>{let e=r.clients.get(t.client);return e!==void 0&&Un(e,t.clock)!==null},oe=r=>{r.clients.forEach(t=>{t.sort((i,s)=>i.clock-s.clock);let e,n;for(e=1,n=1;e<t.length;e++){let i=t[n-1],s=t[e];i.clock+i.len>=s.clock?i.len=A.max(i.len,s.clock+s.len-i.clock):(n<e&&(t[n]=s),n++)}t.length=n})},_t=r=>{let t=new Z;for(let e=0;e<r.length;e++)r[e].clients.forEach((n,i)=>{if(!t.clients.has(i)){let s=n.slice();for(let l=e+1;l<r.length;l++)v.appendTo(s,r[l].clients.get(i)||[]);t.clients.set(i,s)}});return oe(t),t},bt=(r,t,e,n)=>{I.setIfUndefined(r.clients,t,()=>[]).push(new yt(e,n))},ce=()=>new Z,Ge=r=>{let t=ce();return r.clients.forEach((e,n)=>{let i=[];for(let s=0;s<e.length;s++){let l=e[s];if(l.deleted){let o=l.id.clock,c=l.length;if(s+1<e.length)for(let h=e[s+1];s+1<e.length&&h.deleted;h=e[++s+1])c+=h.length;i.push(new yt(o,c))}}i.length>0&&t.clients.set(n,i)}),t},G=(r,t)=>{f.writeVarUint(r.restEncoder,t.clients.size),t.clients.forEach((e,n)=>{r.resetDsCurVal(),f.writeVarUint(r.restEncoder,n);let i=e.length;f.writeVarUint(r.restEncoder,i);for(let s=0;s<i;s++){let l=e[s];r.writeDsClock(l.clock),r.writeDsLen(l.len)}})},X=r=>{let t=new Z,e=p.readVarUint(r.restDecoder);for(let n=0;n<e;n++){r.resetDsCurVal();let i=p.readVarUint(r.restDecoder),s=p.readVarUint(r.restDecoder);if(s>0){let l=I.setIfUndefined(t.clients,i,()=>[]);for(let o=0;o<s;o++)l.push(new yt(r.readDsClock(),r.readDsLen()))}}return t},_e=(r,t,e)=>{let n=new Z,i=p.readVarUint(r.restDecoder);for(let s=0;s<i;s++){r.resetDsCurVal();let l=p.readVarUint(r.restDecoder),o=p.readVarUint(r.restDecoder),c=e.clients.get(l)||[],h=D(e,l);for(let d=0;d<o;d++){let a=r.readDsClock(),u=a+r.readDsLen();if(a<h){h<u&&bt(n,l,h,u-h);let g=F(c,a),w=c[g];for(!w.deleted&&w.id.clock<a&&(c.splice(g+1,0,jt(t,w,a-w.id.clock)),g++);g<c.length&&(w=c[g++],w.id.clock<u);)w.deleted||(u<w.id.clock+w.length&&c.splice(g,0,jt(t,w,u-w.id.clock)),w.delete(t))}else bt(n,l,a,u-a)}}if(n.clients.size>0){let s=new B;return f.writeVarUint(s.restEncoder,0),G(s,n),s.toUint8Array()}return null},He=Kt.uint32,Y=class extends le{constructor({guid:t=Kt.uuidv4(),collectionid:e=null,gc:n=!0,gcFilter:i=()=>!0,meta:s=null,autoLoad:l=!1,shouldLoad:o=!0}={}){super(),this.gc=n,this.gcFilter=i,this.clientID=He(),this.guid=t,this.collectionid=e,this.share=new Map,this.store=new Jt,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=o,this.autoLoad=l,this.meta=s,this.isLoaded=!1,this.whenLoaded=ve.create(c=>{this.on("load",()=>{this.isLoaded=!0,c(this)})})}load(){let t=this._item;t!==null&&!this.shouldLoad&&S(t.parent.doc,e=>{e.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(Array.from(this.subdocs).map(t=>t.guid))}transact(t,e=null){S(this,t,e)}get(t,e=E){let n=I.setIfUndefined(this.share,t,()=>{let s=new e;return s._integrate(this,null),s}),i=n.constructor;if(e!==E&&i!==e)if(i===E){let s=new e;s._map=n._map,n._map.forEach(l=>{for(;l!==null;l=l.left)l.parent=s}),s._start=n._start;for(let l=s._start;l!==null;l=l.right)l.parent=s;return s._length=n._length,this.share.set(t,s),s._integrate(this,null),s}else throw new Error(`Type with the name ${t} has already been defined with a different constructor`);return n}getArray(t=""){return this.get(t,J)}getText(t=""){return this.get(t,et)}getMap(t=""){return this.get(t,z)}getXmlFragment(t=""){return this.get(t,j)}toJSON(){let t={};return this.share.forEach((e,n)=>{t[n]=e.toJSON()}),t}destroy(){v.from(this.subdocs).forEach(e=>e.destroy());let t=this._item;if(t!==null){this._item=null;let e=t.content;e.doc=new Y({guid:this.guid,...e.opts,shouldLoad:!1}),e.doc._item=t,S(t.parent.doc,n=>{let i=e.doc;t.deleted||n.subdocsAdded.add(i),n.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}on(t,e){super.on(t,e)}off(t,e){super.off(t,e)}},it=class{constructor(t){this.restDecoder=t}resetDsCurVal(){}readDsClock(){return p.readVarUint(this.restDecoder)}readDsLen(){return p.readVarUint(this.restDecoder)}},N=class extends it{readLeftID(){return m(p.readVarUint(this.restDecoder),p.readVarUint(this.restDecoder))}readRightID(){return m(p.readVarUint(this.restDecoder),p.readVarUint(this.restDecoder))}readClient(){return p.readVarUint(this.restDecoder)}readInfo(){return p.readUint8(this.restDecoder)}readString(){return p.readVarString(this.restDecoder)}readParentInfo(){return p.readVarUint(this.restDecoder)===1}readTypeRef(){return p.readVarUint(this.restDecoder)}readLen(){return p.readVarUint(this.restDecoder)}readAny(){return p.readAny(this.restDecoder)}readBuf(){return Ne.copyUint8Array(p.readVarUint8Array(this.restDecoder))}readJSON(){return JSON.parse(p.readVarString(this.restDecoder))}readKey(){return p.readVarString(this.restDecoder)}},Nt=class{constructor(t){this.dsCurrVal=0,this.restDecoder=t}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=p.readVarUint(this.restDecoder),this.dsCurrVal}readDsLen(){let t=p.readVarUint(this.restDecoder)+1;return this.dsCurrVal+=t,t}},x=class extends Nt{constructor(t){super(t),this.keys=[],p.readVarUint(t),this.keyClockDecoder=new p.IntDiffOptRleDecoder(p.readVarUint8Array(t)),this.clientDecoder=new p.UintOptRleDecoder(p.readVarUint8Array(t)),this.leftClockDecoder=new p.IntDiffOptRleDecoder(p.readVarUint8Array(t)),this.rightClockDecoder=new p.IntDiffOptRleDecoder(p.readVarUint8Array(t)),this.infoDecoder=new p.RleDecoder(p.readVarUint8Array(t),p.readUint8),this.stringDecoder=new p.StringDecoder(p.readVarUint8Array(t)),this.parentInfoDecoder=new p.RleDecoder(p.readVarUint8Array(t),p.readUint8),this.typeRefDecoder=new p.UintOptRleDecoder(p.readVarUint8Array(t)),this.lenDecoder=new p.UintOptRleDecoder(p.readVarUint8Array(t))}readLeftID(){return new Q(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new Q(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return p.readAny(this.restDecoder)}readBuf(){return p.readVarUint8Array(this.restDecoder)}readJSON(){return p.readAny(this.restDecoder)}readKey(){let t=this.keyClockDecoder.read();if(t<this.keys.length)return this.keys[t];{let e=this.stringDecoder.read();return this.keys.push(e),e}}},P=class{constructor(){this.restEncoder=f.createEncoder()}toUint8Array(){return f.toUint8Array(this.restEncoder)}resetDsCurVal(){}writeDsClock(t){f.writeVarUint(this.restEncoder,t)}writeDsLen(t){f.writeVarUint(this.restEncoder,t)}},tt=class extends P{writeLeftID(t){f.writeVarUint(this.restEncoder,t.client),f.writeVarUint(this.restEncoder,t.clock)}writeRightID(t){f.writeVarUint(this.restEncoder,t.client),f.writeVarUint(this.restEncoder,t.clock)}writeClient(t){f.writeVarUint(this.restEncoder,t)}writeInfo(t){f.writeUint8(this.restEncoder,t)}writeString(t){f.writeVarString(this.restEncoder,t)}writeParentInfo(t){f.writeVarUint(this.restEncoder,t?1:0)}writeTypeRef(t){f.writeVarUint(this.restEncoder,t)}writeLen(t){f.writeVarUint(this.restEncoder,t)}writeAny(t){f.writeAny(this.restEncoder,t)}writeBuf(t){f.writeVarUint8Array(this.restEncoder,t)}writeJSON(t){f.writeVarString(this.restEncoder,JSON.stringify(t))}writeKey(t){f.writeVarString(this.restEncoder,t)}},at=class{constructor(){this.restEncoder=f.createEncoder(),this.dsCurrVal=0}toUint8Array(){return f.toUint8Array(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(t){let e=t-this.dsCurrVal;this.dsCurrVal=t,f.writeVarUint(this.restEncoder,e)}writeDsLen(t){t===0&&C.unexpectedCase(),f.writeVarUint(this.restEncoder,t-1),this.dsCurrVal+=t}},B=class extends at{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new f.IntDiffOptRleEncoder,this.clientEncoder=new f.UintOptRleEncoder,this.leftClockEncoder=new f.IntDiffOptRleEncoder,this.rightClockEncoder=new f.IntDiffOptRleEncoder,this.infoEncoder=new f.RleEncoder(f.writeUint8),this.stringEncoder=new f.StringEncoder,this.parentInfoEncoder=new f.RleEncoder(f.writeUint8),this.typeRefEncoder=new f.UintOptRleEncoder,this.lenEncoder=new f.UintOptRleEncoder}toUint8Array(){let t=f.createEncoder();return f.writeVarUint(t,0),f.writeVarUint8Array(t,this.keyClockEncoder.toUint8Array()),f.writeVarUint8Array(t,this.clientEncoder.toUint8Array()),f.writeVarUint8Array(t,this.leftClockEncoder.toUint8Array()),f.writeVarUint8Array(t,this.rightClockEncoder.toUint8Array()),f.writeVarUint8Array(t,f.toUint8Array(this.infoEncoder)),f.writeVarUint8Array(t,this.stringEncoder.toUint8Array()),f.writeVarUint8Array(t,f.toUint8Array(this.parentInfoEncoder)),f.writeVarUint8Array(t,this.typeRefEncoder.toUint8Array()),f.writeVarUint8Array(t,this.lenEncoder.toUint8Array()),f.writeUint8Array(t,f.toUint8Array(this.restEncoder)),f.toUint8Array(t)}writeLeftID(t){this.clientEncoder.write(t.client),this.leftClockEncoder.write(t.clock)}writeRightID(t){this.clientEncoder.write(t.client),this.rightClockEncoder.write(t.clock)}writeClient(t){this.clientEncoder.write(t)}writeInfo(t){this.infoEncoder.write(t)}writeString(t){this.stringEncoder.write(t)}writeParentInfo(t){this.parentInfoEncoder.write(t?1:0)}writeTypeRef(t){this.typeRefEncoder.write(t)}writeLen(t){this.lenEncoder.write(t)}writeAny(t){f.writeAny(this.restEncoder,t)}writeBuf(t){f.writeVarUint8Array(this.restEncoder,t)}writeJSON(t){f.writeAny(this.restEncoder,t)}writeKey(t){let e=this.keyMap.get(t);e===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(t)):this.keyClockEncoder.write(e)}},En=(r,t,e,n)=>{n=A.max(n,t[0].id.clock);let i=F(t,n);f.writeVarUint(r.restEncoder,t.length-i),r.writeClient(e),f.writeVarUint(r.restEncoder,n);let s=t[i];s.write(r,n-s.id.clock);for(let l=i+1;l<t.length;l++)t[l].write(r,0)},de=(r,t,e)=>{let n=new Map;e.forEach((i,s)=>{D(t,s)>i&&n.set(s,i)}),Vt(t).forEach((i,s)=>{e.has(s)||n.set(s,0)}),f.writeVarUint(r.restEncoder,n.size),Array.from(n.entries()).sort((i,s)=>s[0]-i[0]).forEach(([i,s])=>{En(r,t.clients.get(i),i,s)})},In=(r,t)=>{let e=I.create(),n=p.readVarUint(r.restDecoder);for(let i=0;i<n;i++){let s=p.readVarUint(r.restDecoder),l=new Array(s),o=r.readClient(),c=p.readVarUint(r.restDecoder);e.set(o,{i:0,refs:l});for(let h=0;h<s;h++){let d=r.readInfo();switch(k.BITS5&d){case 0:{let a=r.readLen();l[h]=new O(m(o,c),a),c+=a;break}case 10:{let a=p.readVarUint(r.restDecoder);l[h]=new T(m(o,c),a),c+=a;break}default:{let a=(d&(k.BIT7|k.BIT8))===0,u=new b(m(o,c),null,(d&k.BIT8)===k.BIT8?r.readLeftID():null,null,(d&k.BIT7)===k.BIT7?r.readRightID():null,a?r.readParentInfo()?t.get(r.readString()):r.readLeftID():null,a&&(d&k.BIT6)===k.BIT6?r.readString():null,bn(r,d));l[h]=u,c+=u.length}}}}return e},An=(r,t,e)=>{let n=[],i=Array.from(e.keys()).sort((g,w)=>g-w);if(i.length===0)return null;let s=()=>{if(i.length===0)return null;let g=e.get(i[i.length-1]);for(;g.refs.length===g.i;)if(i.pop(),i.length>0)g=e.get(i[i.length-1]);else return null;return g},l=s();if(l===null&&n.length===0)return null;let o=new Jt,c=new Map,h=(g,w)=>{let y=c.get(g);(y==null||y>w)&&c.set(g,w)},d=l.refs[l.i++],a=new Map,u=()=>{for(let g of n){let w=g.id.client,y=e.get(w);y?(y.i--,o.clients.set(w,y.refs.slice(y.i)),e.delete(w),y.i=0,y.refs=[]):o.clients.set(w,[g]),i=i.filter(_=>_!==w)}n.length=0};for(;;){if(d.constructor!==T){let w=I.setIfUndefined(a,d.id.client,()=>D(t,d.id.client))-d.id.clock;if(w<0)n.push(d),h(d.id.client,d.id.clock-1),u();else{let y=d.getMissing(r,t);if(y!==null){n.push(d);let _=e.get(y)||{refs:[],i:0};if(_.refs.length===_.i)h(y,D(t,y)),u();else{d=_.refs[_.i++];continue}}else(w===0||w<d.length)&&(d.integrate(r,w),a.set(d.id.client,d.id.clock+d.length))}}if(n.length>0)d=n.pop();else if(l!==null&&l.i<l.refs.length)d=l.refs[l.i++];else{if(l=s(),l===null)break;d=l.refs[l.i++]}}if(o.clients.size>0){let g=new B;return de(g,o,new Map),f.writeVarUint(g.restEncoder,0),{missing:c,update:g.toUint8Array()}}return null},Vn=(r,t)=>de(r,t.doc.store,t.beforeState),ze=(r,t,e,n=new x(r))=>S(t,i=>{i.local=!1;let s=!1,l=i.doc,o=l.store,c=In(n,l),h=An(i,o,c),d=o.pendingStructs;if(d){for(let[u,g]of d.missing)if(g<D(o,u)){s=!0;break}if(h){for(let[u,g]of h.missing){let w=d.missing.get(u);(w==null||w>g)&&d.missing.set(u,g)}d.update=Gt([d.update,h.update])}}else o.pendingStructs=h;let a=_e(n,i,o);if(o.pendingDs){let u=new x(p.createDecoder(o.pendingDs));p.readVarUint(u.restDecoder);let g=_e(u,i,o);a&&g?o.pendingDs=Gt([a,g]):o.pendingDs=a||g}else o.pendingDs=a;if(s){let u=o.pendingStructs.update;o.pendingStructs=null,he(i.doc,u)}},e,!1),Or=(r,t,e)=>ze(r,t,e,new N(r)),he=(r,t,e,n=x)=>{let i=p.createDecoder(t);ze(i,r,e,new n(i))},Lr=(r,t,e)=>he(r,t,e,N),Tn=(r,t,e=new Map)=>{de(r,t.store,e),G(r,Ge(t.store))},On=(r,t=new Uint8Array([0]),e=new B)=>{let n=Ke(t);Tn(e,r,n);let i=[e.toUint8Array()];if(r.store.pendingDs&&i.push(r.store.pendingDs),r.store.pendingStructs&&i.push(tn(r.store.pendingStructs.update,t)),i.length>1){if(e.constructor===tt)return jn(i.map((s,l)=>l===0?s:qn(s)));if(e.constructor===B)return Gt(i)}return i[0]},xr=(r,t)=>On(r,t,new tt),je=r=>{let t=new Map,e=p.readVarUint(r.restDecoder);for(let n=0;n<e;n++){let i=p.readVarUint(r.restDecoder),s=p.readVarUint(r.restDecoder);t.set(i,s)}return t},Ke=r=>je(new it(p.createDecoder(r))),ae=(r,t)=>(f.writeVarUint(r.restEncoder,t.size),Array.from(t.entries()).sort((e,n)=>n[0]-e[0]).forEach(([e,n])=>{f.writeVarUint(r.restEncoder,e),f.writeVarUint(r.restEncoder,n)}),r),Ln=(r,t)=>ae(r,Vt(t.store)),xn=(r,t=new at)=>(r instanceof Map?ae(t,r):Ln(t,r),t.toUint8Array()),Mr=r=>xn(r,new P),Qt=class{constructor(){this.l=[]}},be=()=>new Qt,Se=(r,t)=>r.l.push(t),Ce=(r,t)=>{let e=r.l,n=e.length;r.l=e.filter(i=>t!==i),n===r.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},$e=(r,t,e)=>Be.callAll(r.l,[t,e]),Q=class{constructor(t,e){this.client=t,this.clock=e}},dt=(r,t)=>r===t||r!==null&&t!==null&&r.client===t.client&&r.clock===t.clock,m=(r,t)=>new Q(r,t),De=(r,t)=>{f.writeVarUint(r,t.client),f.writeVarUint(r,t.clock)},Ue=r=>m(p.readVarUint(r),p.readVarUint(r)),We=r=>{for(let[t,e]of r.doc.share.entries())if(e===r)return t;throw C.unexpectedCase()},Bt=(r,t)=>{for(;t!==null;){if(t.parent===r)return!0;t=t.parent._item}return!1},Rr=r=>{let t=[],e=r._start;for(;e;)t.push(e),e=e.right;console.log("Children: ",t),console.log("Children content: ",t.filter(n=>!n.deleted).map(n=>n.content))},Ee=class{constructor(t,e=t.getMap("users")){let n=new Map;this.yusers=e,this.doc=t,this.clients=new Map,this.dss=n;let i=(s,l)=>{let o=s.get("ds"),c=s.get("ids"),h=d=>this.clients.set(d,l);o.observe(d=>{d.changes.added.forEach(a=>{a.content.getContent().forEach(u=>{u instanceof Uint8Array&&this.dss.set(l,_t([this.dss.get(l)||ce(),X(new it(p.createDecoder(u)))]))})})}),this.dss.set(l,_t(o.map(d=>X(new it(p.createDecoder(d)))))),c.observe(d=>d.changes.added.forEach(a=>a.content.getContent().forEach(h))),c.forEach(h)};e.observe(s=>{s.keysChanged.forEach(l=>i(e.get(l),l))}),e.forEach(i)}setUserMapping(t,e,n,{filter:i=()=>!0}={}){let s=this.yusers,l=s.get(n);l||(l=new z,l.set("ids",new J),l.set("ds",new J),s.set(n,l)),l.get("ids").push([e]),s.observe(o=>{setTimeout(()=>{let c=s.get(n);if(c!==l){l=c,this.clients.forEach((a,u)=>{n===a&&l.get("ids").push([u])});let h=new P,d=this.dss.get(n);d&&(G(h,d),l.get("ds").push([h.toUint8Array()]))}},0)}),t.on("afterTransaction",o=>{setTimeout(()=>{let c=l.get("ds"),h=o.deleteSet;if(o.local&&h.clients.size>0&&i(o,h)){let d=new P;G(d,h),c.push([d.toUint8Array()])}})})}getUserByClientId(t){return this.clients.get(t)||null}getUserByDeletedId(t){for(let[e,n]of this.dss.entries())if(At(n,t))return e;return null}},St=class{constructor(t,e,n,i=0){this.type=t,this.tname=e,this.item=n,this.assoc=i}},vr=r=>{let t={};return r.type&&(t.type=r.type),r.tname&&(t.tname=r.tname),r.item&&(t.item=r.item),r.assoc!=null&&(t.assoc=r.assoc),t},Nr=r=>new St(r.type==null?null:m(r.type.client,r.type.clock),r.tname||null,r.item==null?null:m(r.item.client,r.item.clock),r.assoc==null?0:r.assoc),Zt=class{constructor(t,e,n=0){this.type=t,this.index=e,this.assoc=n}},Mn=(r,t,e=0)=>new Zt(r,t,e),Ot=(r,t,e)=>{let n=null,i=null;return r._item===null?i=We(r):n=m(r._item.id.client,r._item.id.clock),new St(n,i,t,e)},Br=(r,t,e=0)=>{let n=r._start;if(e<0){if(t===0)return Ot(r,null,e);t--}for(;n!==null;){if(!n.deleted&&n.countable){if(n.length>t)return Ot(r,m(n.id.client,n.id.clock+t),e);t-=n.length}if(n.right===null&&e<0)return Ot(r,n.lastId,e);n=n.right}return Ot(r,null,e)},Rn=(r,t)=>{let{type:e,tname:n,item:i,assoc:s}=t;if(i!==null)f.writeVarUint(r,0),De(r,i);else if(n!==null)f.writeUint8(r,1),f.writeVarString(r,n);else if(e!==null)f.writeUint8(r,2),De(r,e);else throw C.unexpectedCase();return f.writeVarInt(r,s),r},Fr=r=>{let t=f.createEncoder();return Rn(t,r),f.toUint8Array(t)},vn=r=>{let t=null,e=null,n=null;switch(p.readVarUint(r)){case 0:n=Ue(r);break;case 1:e=p.readVarString(r);break;case 2:t=Ue(r)}let i=p.hasContent(r)?p.readVarInt(r):0;return new St(t,e,n,i)},Jr=r=>vn(p.createDecoder(r)),Gr=(r,t)=>{let e=t.store,n=r.item,i=r.type,s=r.tname,l=r.assoc,o=null,c=0;if(n!==null){if(D(e,n.client)<=n.clock)return null;let h=se(e,n),d=h.item;if(!(d instanceof b))return null;if(o=d.parent,o._item===null||!o._item.deleted){c=d.deleted||!d.countable?0:h.diff+(l>=0?0:1);let a=d.left;for(;a!==null;)!a.deleted&&a.countable&&(c+=a.length),a=a.left}}else{if(s!==null)o=t.get(s);else if(i!==null){if(D(e,i.client)<=i.clock)return null;let{item:h}=se(e,i);if(h instanceof b&&h.content instanceof R)o=h.content.type;else return null}else throw C.unexpectedCase();l>=0?c=o._length:c=0}return Mn(o,c,r.assoc)},Hr=(r,t)=>r===t||r!==null&&t!==null&&r.tname===t.tname&&dt(r.item,t.item)&&dt(r.type,t.type)&&r.assoc===t.assoc,Ft=class{constructor(t,e){this.ds=t,this.sv=e}},zr=(r,t)=>{let e=r.ds.clients,n=t.ds.clients,i=r.sv,s=t.sv;if(i.size!==s.size||e.size!==n.size)return!1;for(let[l,o]of i.entries())if(s.get(l)!==o)return!1;for(let[l,o]of e.entries()){let c=n.get(l)||[];if(o.length!==c.length)return!1;for(let h=0;h<o.length;h++){let d=o[h],a=c[h];if(d.clock!==a.clock||d.len!==a.len)return!1}}return!0},Nn=(r,t=new at)=>(G(t,r.ds),ae(t,r.sv),t.toUint8Array()),jr=r=>Nn(r,new P),Bn=(r,t=new Nt(p.createDecoder(r)))=>new Ft(X(t),je(t)),Kr=r=>Bn(r,new it(p.createDecoder(r))),qe=(r,t)=>new Ft(r,t),$r=qe(ce(),new Map),Wr=r=>qe(Ge(r.store),Vt(r.store)),nt=(r,t)=>t===void 0?!r.deleted:t.sv.has(r.id.client)&&(t.sv.get(r.id.client)||0)>r.id.clock&&!At(t.ds,r.id),Mt=(r,t)=>{let e=I.setIfUndefined(r.meta,Mt,kt.create),n=r.doc.store;e.has(t)||(t.sv.forEach((i,s)=>{i<D(n,s)&&V(r,m(s,i))}),rt(r,t.ds,i=>{}),e.add(t))},qr=(r,t,e=new Y)=>{if(r.gc)throw new Error("originDoc must not be garbage collected");let{sv:n,ds:i}=t,s=new B;return r.transact(l=>{let o=0;n.forEach(c=>{c>0&&o++}),f.writeVarUint(s.restEncoder,o);for(let[c,h]of n){if(h===0)continue;h<D(r.store,c)&&V(l,m(c,h));let d=r.store.clients.get(c)||[],a=F(d,h-1);f.writeVarUint(s.restEncoder,a+1),s.writeClient(c),f.writeVarUint(s.restEncoder,0);for(let u=0;u<=a;u++)d[u].write(s,0)}G(s,i)}),he(e,s.toUint8Array(),"snapshot"),e},Jt=class{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}},Vt=r=>{let t=new Map;return r.clients.forEach((e,n)=>{let i=e[e.length-1];t.set(n,i.id.clock+i.length)}),t},D=(r,t)=>{let e=r.clients.get(t);if(e===void 0)return 0;let n=e[e.length-1];return n.id.clock+n.length},Qe=(r,t)=>{let e=r.clients.get(t.id.client);if(e===void 0)e=[],r.clients.set(t.id.client,e);else{let n=e[e.length-1];if(n.id.clock+n.length!==t.id.clock)throw C.unexpectedCase()}e.push(t)},F=(r,t)=>{let e=0,n=r.length-1,i=r[n],s=i.id.clock;if(s===t)return n;let l=A.floor(t/(s+i.length-1)*n);for(;e<=n;){if(i=r[l],s=i.id.clock,s<=t){if(t<s+i.length)return l;e=l+1}else n=l-1;l=A.floor((e+n)/2)}throw C.unexpectedCase()},Fn=(r,t)=>{let e=r.clients.get(t.client);return e[F(e,t.clock)]},Rt=Fn,Xt=(r,t,e)=>{let n=F(t,e),i=t[n];return i.id.clock<e&&i instanceof b?(t.splice(n+1,0,jt(r,i,e-i.id.clock)),n+1):n},V=(r,t)=>{let e=r.doc.store.clients.get(t.client);return e[Xt(r,e,t.clock)]},Ie=(r,t,e)=>{let n=t.clients.get(e.client),i=F(n,e.clock),s=n[i];return e.clock!==s.id.clock+s.length-1&&s.constructor!==O&&n.splice(i+1,0,jt(r,s,e.clock-s.id.clock+1)),s},Jn=(r,t,e)=>{let n=r.clients.get(t.id.client);n[F(n,t.id.clock)]=e},Ze=(r,t,e,n,i)=>{if(n===0)return;let s=e+n,l=Xt(r,t,e),o;do o=t[l++],s<o.id.clock+o.length&&Xt(r,t,s),i(o);while(l<t.length&&t[l].id.clock<s)},Yt=class{constructor(t,e,n){this.doc=t,this.deleteSet=new Z,this.beforeState=Vt(t.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=e,this.meta=new Map,this.local=n,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set}},Ae=(r,t)=>t.deleteSet.clients.size===0&&!I.any(t.afterState,(e,n)=>t.beforeState.get(n)!==e)?!1:(oe(t.deleteSet),Vn(r,t),G(r,t.deleteSet),!0),Ve=(r,t,e)=>{let n=t._item;(n===null||n.id.clock<(r.beforeState.get(n.id.client)||0)&&!n.deleted)&&I.setIfUndefined(r.changed,t,kt.create).add(e)},vt=(r,t)=>{let e=r[t-1],n=r[t];e.deleted===n.deleted&&e.constructor===n.constructor&&e.mergeWith(n)&&(r.splice(t,1),n instanceof b&&n.parentSub!==null&&n.parent._map.get(n.parentSub)===n&&n.parent._map.set(n.parentSub,e))},Xe=(r,t,e)=>{for(let[n,i]of r.clients.entries()){let s=t.clients.get(n);for(let l=i.length-1;l>=0;l--){let o=i[l],c=o.clock+o.len;for(let h=F(s,o.clock),d=s[h];h<s.length&&d.id.clock<c;d=s[++h]){let a=s[h];if(o.clock+o.len<=a.id.clock)break;a instanceof b&&a.deleted&&!a.keep&&e(a)&&a.gc(t,!1)}}}},Ye=(r,t)=>{r.clients.forEach((e,n)=>{let i=t.clients.get(n);for(let s=e.length-1;s>=0;s--){let l=e[s],o=A.min(i.length-1,1+F(i,l.clock+l.len-1));for(let c=o,h=i[c];c>0&&h.id.clock>=l.clock;h=i[--c])vt(i,c)}})},Qr=(r,t,e)=>{Xe(r,t,e),Ye(r,t)},Pe=(r,t)=>{if(t<r.length){let e=r[t],n=e.doc,i=n.store,s=e.deleteSet,l=e._mergeStructs;try{oe(s),e.afterState=Vt(e.doc.store),n._transaction=null,n.emit("beforeObserverCalls",[e,n]);let o=[];e.changed.forEach((c,h)=>o.push(()=>{(h._item===null||!h._item.deleted)&&h._callObserver(e,c)})),o.push(()=>{e.changedParentTypes.forEach((c,h)=>o.push(()=>{(h._item===null||!h._item.deleted)&&(c=c.filter(d=>d.target._item===null||!d.target._item.deleted),c.forEach(d=>{d.currentTarget=h}),c.sort((d,a)=>d.path.length-a.path.length),$e(h._dEH,c,e))})),o.push(()=>n.emit("afterTransaction",[e,n]))}),Dn(o,[])}finally{n.gc&&Xe(s,i,n.gcFilter),Ye(s,i),e.afterState.forEach((d,a)=>{let u=e.beforeState.get(a)||0;if(u!==d){let g=i.clients.get(a),w=A.max(F(g,u),1);for(let y=g.length-1;y>=w;y--)vt(g,y)}});for(let d=0;d<l.length;d++){let{client:a,clock:u}=l[d].id,g=i.clients.get(a),w=F(g,u);w+1<g.length&&vt(g,w+1),w>0&&vt(g,w)}if(!e.local&&e.afterState.get(n.clientID)!==e.beforeState.get(n.clientID)&&(L.print(L.ORANGE,L.BOLD,"[yjs] ",L.UNBOLD,L.RED,"Changed the client-id because another client seems to be using it."),n.clientID=He()),n.emit("afterTransactionCleanup",[e,n]),n._observers.has("update")){let d=new tt;Ae(d,e)&&n.emit("update",[d.toUint8Array(),e.origin,n,e])}if(n._observers.has("updateV2")){let d=new B;Ae(d,e)&&n.emit("updateV2",[d.toUint8Array(),e.origin,n,e])}let{subdocsAdded:o,subdocsLoaded:c,subdocsRemoved:h}=e;(o.size>0||h.size>0||c.size>0)&&(o.forEach(d=>{d.clientID=n.clientID,d.collectionid==null&&(d.collectionid=n.collectionid),n.subdocs.add(d)}),h.forEach(d=>n.subdocs.delete(d)),n.emit("subdocs",[{loaded:c,added:o,removed:h},n,e]),h.forEach(d=>d.destroy())),r.length<=t+1?(n._transactionCleanups=[],n.emit("afterAllTransactions",[n,r])):Pe(r,t+1)}}},S=(r,t,e=null,n=!0)=>{let i=r._transactionCleanups,s=!1;r._transaction===null&&(s=!0,r._transaction=new Yt(r,e,n),i.push(r._transaction),i.length===1&&r.emit("beforeAllTransactions",[r]),r.emit("beforeTransaction",[r._transaction,r]));try{t(r._transaction)}finally{s&&i[0]===r._transaction&&Pe(i,0)}},Pt=class{constructor(t,e){this.insertions=e,this.deletions=t,this.meta=new Map}},Te=(r,t,e)=>{rt(r,e.deletions,n=>{n instanceof b&&t.scope.some(i=>Bt(i,n))&&we(n,!1)})},Oe=(r,t,e)=>{let n=null,i=null,s=r.doc,l=r.scope;if(S(s,o=>{for(;t.length>0&&n===null;){let c=s.store,h=t.pop(),d=new Set,a=[],u=!1;rt(o,h.insertions,g=>{if(g instanceof b){if(g.redone!==null){let{item:w,diff:y}=se(c,g.id);y>0&&(w=V(o,m(w.id.client,w.id.clock+y))),g=w}!g.deleted&&l.some(w=>Bt(w,g))&&a.push(g)}}),rt(o,h.deletions,g=>{g instanceof b&&l.some(w=>Bt(w,g))&&!At(h.insertions,g.id)&&d.add(g)}),d.forEach(g=>{u=_n(o,g,d,h.insertions,r.ignoreRemoteMapChanges)!==null||u});for(let g=a.length-1;g>=0;g--){let w=a[g];r.deleteFilter(w)&&(w.delete(o),u=!0)}n=u?h:null}o.changed.forEach((c,h)=>{c.has(null)&&h._searchMarker&&(h._searchMarker.length=0)}),i=o},r),n!=null){let o=i.changedParentTypes;r.emit("stack-item-popped",[{stackItem:n,type:e,changedParentTypes:o},r])}return n},Le=class extends le{constructor(t,{captureTimeout:e=500,captureTransaction:n=c=>!0,deleteFilter:i=()=>!0,trackedOrigins:s=new Set([null]),ignoreRemoteMapChanges:l=!1,doc:o=v.isArray(t)?t[0].doc:t.doc}={}){super(),this.scope=[],this.addToScope(t),this.deleteFilter=i,s.add(this),this.trackedOrigins=s,this.captureTransaction=n,this.undoStack=[],this.redoStack=[],this.undoing=!1,this.redoing=!1,this.doc=o,this.lastChange=0,this.ignoreRemoteMapChanges=l,this.captureTimeout=e,this.afterTransactionHandler=c=>{if(!this.captureTransaction(c)||!this.scope.some(_=>c.changedParentTypes.has(_))||!this.trackedOrigins.has(c.origin)&&(!c.origin||!this.trackedOrigins.has(c.origin.constructor)))return;let h=this.undoing,d=this.redoing,a=h?this.redoStack:this.undoStack;h?this.stopCapturing():d||this.clear(!1,!0);let u=new Z;c.afterState.forEach((_,Tt)=>{let me=c.beforeState.get(Tt)||0,ke=_-me;ke>0&&bt(u,Tt,me,ke)});let g=Fe.getUnixTime(),w=!1;if(this.lastChange>0&&g-this.lastChange<this.captureTimeout&&a.length>0&&!h&&!d){let _=a[a.length-1];_.deletions=_t([_.deletions,c.deleteSet]),_.insertions=_t([_.insertions,u])}else a.push(new Pt(c.deleteSet,u)),w=!0;!h&&!d&&(this.lastChange=g),rt(c,c.deleteSet,_=>{_ instanceof b&&this.scope.some(Tt=>Bt(Tt,_))&&we(_,!0)});let y=[{stackItem:a[a.length-1],origin:c.origin,type:h?"redo":"undo",changedParentTypes:c.changedParentTypes},this];w?this.emit("stack-item-added",y):this.emit("stack-item-updated",y)},this.doc.on("afterTransaction",this.afterTransactionHandler),this.doc.on("destroy",()=>{this.destroy()})}addToScope(t){t=v.isArray(t)?t:[t],t.forEach(e=>{this.scope.every(n=>n!==e)&&this.scope.push(e)})}addTrackedOrigin(t){this.trackedOrigins.add(t)}removeTrackedOrigin(t){this.trackedOrigins.delete(t)}clear(t=!0,e=!0){(t&&this.canUndo()||e&&this.canRedo())&&this.doc.transact(n=>{t&&(this.undoStack.forEach(i=>Te(n,this,i)),this.undoStack=[]),e&&(this.redoStack.forEach(i=>Te(n,this,i)),this.redoStack=[]),this.emit("stack-cleared",[{undoStackCleared:t,redoStackCleared:e}])})}stopCapturing(){this.lastChange=0}undo(){this.undoing=!0;let t;try{t=Oe(this,this.undoStack,"undo")}finally{this.undoing=!1}return t}redo(){this.redoing=!0;let t;try{t=Oe(this,this.redoStack,"redo")}finally{this.redoing=!1}return t}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}destroy(){this.trackedOrigins.delete(this),this.doc.off("afterTransaction",this.afterTransactionHandler),super.destroy()}};function*Gn(r){let t=p.readVarUint(r.restDecoder);for(let e=0;e<t;e++){let n=p.readVarUint(r.restDecoder),i=r.readClient(),s=p.readVarUint(r.restDecoder);for(let l=0;l<n;l++){let o=r.readInfo();if(o===10){let c=p.readVarUint(r.restDecoder);yield new T(m(i,s),c),s+=c}else if(k.BITS5&o){let c=(o&(k.BIT7|k.BIT8))===0,h=new b(m(i,s),null,(o&k.BIT8)===k.BIT8?r.readLeftID():null,null,(o&k.BIT7)===k.BIT7?r.readRightID():null,c?r.readParentInfo()?r.readString():r.readLeftID():null,c&&(o&k.BIT6)===k.BIT6?r.readString():null,bn(r,o));yield h,s+=h.length}else{let c=r.readLen();yield new O(m(i,s),c),s+=c}}}}var H=class{constructor(t,e){this.gen=Gn(t),this.curr=null,this.done=!1,this.filterSkips=e,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===T);return this.curr}},Zr=r=>Hn(r,N),Hn=(r,t=x)=>{let e=[],n=new t(p.createDecoder(r)),i=new H(n,!1);for(let l=i.curr;l!==null;l=i.next())e.push(l);L.print("Structs: ",e);let s=X(n);L.print("DeleteSet: ",s)},Xr=r=>zn(r,N),zn=(r,t=x)=>{let e=[],n=new t(p.createDecoder(r)),i=new H(n,!1);for(let s=i.curr;s!==null;s=i.next())e.push(s);return{structs:e,ds:X(n)}},Ct=class{constructor(t){this.currClient=0,this.startClock=0,this.written=0,this.encoder=t,this.clientStructs=[]}},jn=r=>Gt(r,N,tt),Kn=(r,t=at,e=x)=>{let n=new t,i=new H(new e(p.createDecoder(r)),!1),s=i.curr;if(s!==null){let l=0,o=s.id.client,c=s.id.clock!==0,h=c?0:s.id.clock+s.length;for(;s!==null;s=i.next())o!==s.id.client&&(h!==0&&(l++,f.writeVarUint(n.restEncoder,o),f.writeVarUint(n.restEncoder,h)),o=s.id.client,h=0,c=s.id.clock!==0),s.constructor===T&&(c=!0),c||(h=s.id.clock+s.length);h!==0&&(l++,f.writeVarUint(n.restEncoder,o),f.writeVarUint(n.restEncoder,h));let d=f.createEncoder();return f.writeVarUint(d,l),f.writeBinaryEncoder(d,n.restEncoder),n.restEncoder=d,n.toUint8Array()}else return f.writeVarUint(n.restEncoder,0),n.toUint8Array()},Yr=r=>Kn(r,P,N),$n=(r,t=x)=>{let e=new Map,n=new Map,i=new H(new t(p.createDecoder(r)),!1),s=i.curr;if(s!==null){let l=s.id.client,o=s.id.clock;for(e.set(l,o);s!==null;s=i.next())l!==s.id.client&&(n.set(l,o),e.set(s.id.client,s.id.clock),l=s.id.client),o=s.id.clock+s.length;n.set(l,o)}return{from:e,to:n}},Pr=r=>$n(r,N),Wn=(r,t)=>{if(r.constructor===O){let{client:e,clock:n}=r.id;return new O(m(e,n+t),r.length-t)}else if(r.constructor===T){let{client:e,clock:n}=r.id;return new T(m(e,n+t),r.length-t)}else{let e=r,{client:n,clock:i}=e.id;return new b(m(n,i+t),null,m(n,i+t-1),null,e.rightOrigin,e.parent,e.parentSub,e.content.splice(t))}},Gt=(r,t=x,e=B)=>{if(r.length===1)return r[0];let n=r.map(d=>new t(p.createDecoder(d))),i=n.map(d=>new H(d,!0)),s=null,l=new e,o=new Ct(l);for(;i=i.filter(u=>u.curr!==null),i.sort((u,g)=>{if(u.curr.id.client===g.curr.id.client){let w=u.curr.id.clock-g.curr.id.clock;return w===0?u.curr.constructor===g.curr.constructor?0:u.curr.constructor===T?1:-1:w}else return g.curr.id.client-u.curr.id.client}),i.length!==0;){let d=i[0],a=d.curr.id.client;if(s!==null){let u=d.curr,g=!1;for(;u!==null&&u.id.clock+u.length<=s.struct.id.clock+s.struct.length&&u.id.client>=s.struct.id.client;)u=d.next(),g=!0;if(u===null||u.id.client!==a||g&&u.id.clock>s.struct.id.clock+s.struct.length)continue;if(a!==s.struct.id.client)W(o,s.struct,s.offset),s={struct:u,offset:0},d.next();else if(s.struct.id.clock+s.struct.length<u.id.clock)if(s.struct.constructor===T)s.struct.length=u.id.clock+u.length-s.struct.id.clock;else{W(o,s.struct,s.offset);let w=u.id.clock-s.struct.id.clock-s.struct.length;s={struct:new T(m(a,s.struct.id.clock+s.struct.length),w),offset:0}}else{let w=s.struct.id.clock+s.struct.length-u.id.clock;w>0&&(s.struct.constructor===T?s.struct.length-=w:u=Wn(u,w)),s.struct.mergeWith(u)||(W(o,s.struct,s.offset),s={struct:u,offset:0},d.next())}}else s={struct:d.curr,offset:0},d.next();for(let u=d.curr;u!==null&&u.id.client===a&&u.id.clock===s.struct.id.clock+s.struct.length&&u.constructor!==T;u=d.next())W(o,s.struct,s.offset),s={struct:u,offset:0}}s!==null&&(W(o,s.struct,s.offset),s=null),ue(o);let c=n.map(d=>X(d)),h=_t(c);return G(l,h),l.toUint8Array()},tn=(r,t,e=x,n=B)=>{let i=Ke(t),s=new n,l=new Ct(s),o=new e(p.createDecoder(r)),c=new H(o,!1);for(;c.curr;){let d=c.curr,a=d.id.client,u=i.get(a)||0;if(c.curr.constructor===T){c.next();continue}if(d.id.clock+d.length>u)for(W(l,d,A.max(u-d.id.clock,0)),c.next();c.curr&&c.curr.id.client===a;)W(l,c.curr,0),c.next();else for(;c.curr&&c.curr.id.client===a&&c.curr.id.clock+c.curr.length<=u;)c.next()}ue(l);let h=X(o);return G(s,h),s.toUint8Array()},ti=(r,t)=>tn(r,t,N,tt),en=r=>{r.written>0&&(r.clientStructs.push({written:r.written,restEncoder:f.toUint8Array(r.encoder.restEncoder)}),r.encoder.restEncoder=f.createEncoder(),r.written=0)},W=(r,t,e)=>{r.written>0&&r.currClient!==t.id.client&&en(r),r.written===0&&(r.currClient=t.id.client,r.encoder.writeClient(t.id.client),f.writeVarUint(r.encoder.restEncoder,t.id.clock+e)),t.write(r.encoder,e),r.written++},ue=r=>{en(r);let t=r.encoder.restEncoder;f.writeVarUint(t,r.clientStructs.length);for(let e=0;e<r.clientStructs.length;e++){let n=r.clientStructs[e];f.writeVarUint(t,n.written),f.writeUint8Array(t,n.restEncoder)}},nn=(r,t,e)=>{let n=new t(p.createDecoder(r)),i=new H(n,!1),s=new e,l=new Ct(s);for(let c=i.curr;c!==null;c=i.next())W(l,c,0);ue(l);let o=X(n);return G(s,o),s.toUint8Array()},ei=r=>nn(r,N,B),qn=r=>nn(r,x,tt),ut=class{constructor(t,e){this.target=t,this.currentTarget=t,this.transaction=e,this._changes=null,this._keys=null,this._delta=null}get path(){return Qn(this.currentTarget,this.target)}deletes(t){return At(this.transaction.deleteSet,t.id)}get keys(){if(this._keys===null){let t=new Map,e=this.target;this.transaction.changed.get(e).forEach(i=>{if(i!==null){let s=e._map.get(i),l,o;if(this.adds(s)){let c=s.left;for(;c!==null&&this.adds(c);)c=c.left;if(this.deletes(s))if(c!==null&&this.deletes(c))l="delete",o=v.last(c.content.getContent());else return;else c!==null&&this.deletes(c)?(l="update",o=v.last(c.content.getContent())):(l="add",o=void 0)}else if(this.deletes(s))l="delete",o=v.last(s.content.getContent());else return;t.set(i,{action:l,oldValue:o})}}),this._keys=t}return this._keys}get delta(){return this.changes.delta}adds(t){return t.id.clock>=(this.transaction.beforeState.get(t.id.client)||0)}get changes(){let t=this._changes;if(t===null){let e=this.target,n=kt.create(),i=kt.create(),s=[];if(t={added:n,deleted:i,delta:s,keys:this.keys},this.transaction.changed.get(e).has(null)){let o=null,c=()=>{o&&s.push(o)};for(let h=e._start;h!==null;h=h.right)h.deleted?this.deletes(h)&&!this.adds(h)&&((o===null||o.delete===void 0)&&(c(),o={delete:0}),o.delete+=h.length,i.add(h)):this.adds(h)?((o===null||o.insert===void 0)&&(c(),o={insert:[]}),o.insert=o.insert.concat(h.content.getContent()),n.add(h)):((o===null||o.retain===void 0)&&(c(),o={retain:0}),o.retain+=h.length);o!==null&&o.retain===void 0&&c()}this._changes=t}return t}},Qn=(r,t)=>{let e=[];for(;t._item!==null&&t!==r;){if(t._item.parentSub!==null)e.unshift(t._item.parentSub);else{let n=0,i=t._item.parent._start;for(;i!==t._item&&i!==null;)i.deleted||n++,i=i.right;e.unshift(n)}t=t._item.parent}return e},rn=80,ge=0,te=class{constructor(t,e){t.marker=!0,this.p=t,this.index=e,this.timestamp=ge++}},Zn=r=>{r.timestamp=ge++},sn=(r,t,e)=>{r.p.marker=!1,r.p=t,t.marker=!0,r.index=e,r.timestamp=ge++},Xn=(r,t,e)=>{if(r.length>=rn){let n=r.reduce((i,s)=>i.timestamp<s.timestamp?i:s);return sn(n,t,e),n}else{let n=new te(t,e);return r.push(n),n}},$t=(r,t)=>{if(r._start===null||t===0||r._searchMarker===null)return null;let e=r._searchMarker.length===0?null:r._searchMarker.reduce((s,l)=>A.abs(t-s.index)<A.abs(t-l.index)?s:l),n=r._start,i=0;for(e!==null&&(n=e.p,i=e.index,Zn(e));n.right!==null&&i<t;){if(!n.deleted&&n.countable){if(t<i+n.length)break;i+=n.length}n=n.right}for(;n.left!==null&&i>t;)n=n.left,!n.deleted&&n.countable&&(i-=n.length);for(;n.left!==null&&n.left.id.client===n.id.client&&n.left.id.clock+n.left.length===n.id.clock;)n=n.left,!n.deleted&&n.countable&&(i-=n.length);return e!==null&&A.abs(e.index-i)<n.parent.length/rn?(sn(e,n,i),e):Xn(r._searchMarker,n,i)},Dt=(r,t,e)=>{for(let n=r.length-1;n>=0;n--){let i=r[n];if(e>0){let s=i.p;for(s.marker=!1;s&&(s.deleted||!s.countable);)s=s.left,s&&!s.deleted&&s.countable&&(i.index-=s.length);if(s===null||s.marker===!0){r.splice(n,1);continue}i.p=s,s.marker=!0}(t<i.index||e>0&&t===i.index)&&(i.index=A.max(t,i.index+e))}},ni=r=>{let t=r._start,e=[];for(;t;)e.push(t),t=t.right;return e},Wt=(r,t,e)=>{let n=r,i=t.changedParentTypes;for(;I.setIfUndefined(i,r,()=>[]).push(e),r._item!==null;)r=r._item.parent;$e(n._eH,e,t)},E=class{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=be(),this._dEH=be(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(t,e){this.doc=t,this._item=e}_copy(){throw C.methodUnimplemented()}clone(){throw C.methodUnimplemented()}_write(t){}get _first(){let t=this._start;for(;t!==null&&t.deleted;)t=t.right;return t}_callObserver(t,e){!t.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(t){Se(this._eH,t)}observeDeep(t){Se(this._dEH,t)}unobserve(t){Ce(this._eH,t)}unobserveDeep(t){Ce(this._dEH,t)}toJSON(){}},ln=(r,t,e)=>{t<0&&(t=r._length+t),e<0&&(e=r._length+e);let n=e-t,i=[],s=r._start;for(;s!==null&&n>0;){if(s.countable&&!s.deleted){let l=s.content.getContent();if(l.length<=t)t-=l.length;else{for(let o=t;o<l.length&&n>0;o++)i.push(l[o]),n--;t=0}}s=s.right}return i},on=r=>{let t=[],e=r._start;for(;e!==null;){if(e.countable&&!e.deleted){let n=e.content.getContent();for(let i=0;i<n.length;i++)t.push(n[i])}e=e.right}return t},ri=(r,t)=>{let e=[],n=r._start;for(;n!==null;){if(n.countable&&nt(n,t)){let i=n.content.getContent();for(let s=0;s<i.length;s++)e.push(i[s])}n=n.right}return e},Ut=(r,t)=>{let e=0,n=r._start;for(;n!==null;){if(n.countable&&!n.deleted){let i=n.content.getContent();for(let s=0;s<i.length;s++)t(i[s],e++,r)}n=n.right}},cn=(r,t)=>{let e=[];return Ut(r,(n,i)=>{e.push(t(n,i,r))}),e},Yn=r=>{let t=r._start,e=null,n=0;return{[Symbol.iterator](){return this},next:()=>{if(e===null){for(;t!==null&&t.deleted;)t=t.right;if(t===null)return{done:!0,value:void 0};e=t.content.getContent(),n=0,t=t.right}let i=e[n++];return e.length<=n&&(e=null),{done:!1,value:i}}}},dn=(r,t)=>{let e=$t(r,t),n=r._start;for(e!==null&&(n=e.p,t-=e.index);n!==null;n=n.right)if(!n.deleted&&n.countable){if(t<n.length)return n.content.getContent()[t];t-=n.length}},Ht=(r,t,e,n)=>{let i=e,s=r.doc,l=s.clientID,o=s.store,c=e===null?t._start:e.right,h=[],d=()=>{h.length>0&&(i=new b(m(l,D(o,l)),i,i&&i.lastId,c,c&&c.id,t,null,new $(h)),i.integrate(r,0),h=[])};n.forEach(a=>{if(a===null)h.push(a);else switch(a.constructor){case Number:case Object:case Boolean:case Array:case String:h.push(a);break;default:switch(d(),a.constructor){case Uint8Array:case ArrayBuffer:i=new b(m(l,D(o,l)),i,i&&i.lastId,c,c&&c.id,t,null,new lt(new Uint8Array(a))),i.integrate(r,0);break;case Y:i=new b(m(l,D(o,l)),i,i&&i.lastId,c,c&&c.id,t,null,new ct(a)),i.integrate(r,0);break;default:if(a instanceof E)i=new b(m(l,D(o,l)),i,i&&i.lastId,c,c&&c.id,t,null,new R(a)),i.integrate(r,0);else throw new Error("Unexpected content type in insert operation")}}}),d()},hn=C.create("Length exceeded!"),an=(r,t,e,n)=>{if(e>t._length)throw hn;if(e===0)return t._searchMarker&&Dt(t._searchMarker,e,n.length),Ht(r,t,null,n);let i=e,s=$t(t,e),l=t._start;for(s!==null&&(l=s.p,e-=s.index,e===0&&(l=l.prev,e+=l&&l.countable&&!l.deleted?l.length:0));l!==null;l=l.right)if(!l.deleted&&l.countable){if(e<=l.length){e<l.length&&V(r,m(l.id.client,l.id.clock+e));break}e-=l.length}return t._searchMarker&&Dt(t._searchMarker,i,n.length),Ht(r,t,l,n)},Pn=(r,t,e)=>{let i=(t._searchMarker||[]).reduce((s,l)=>l.index>s.index?l:s,{index:0,p:t._start}).p;if(i)for(;i.right;)i=i.right;return Ht(r,t,i,e)},un=(r,t,e,n)=>{if(n===0)return;let i=e,s=n,l=$t(t,e),o=t._start;for(l!==null&&(o=l.p,e-=l.index);o!==null&&e>0;o=o.right)!o.deleted&&o.countable&&(e<o.length&&V(r,m(o.id.client,o.id.clock+e)),e-=o.length);for(;n>0&&o!==null;)o.deleted||(n<o.length&&V(r,m(o.id.client,o.id.clock+n)),o.delete(r),n-=o.length),o=o.right;if(n>0)throw hn;t._searchMarker&&Dt(t._searchMarker,i,-s+n)},zt=(r,t,e)=>{let n=t._map.get(e);n!==void 0&&n.delete(r)},fe=(r,t,e,n)=>{let i=t._map.get(e)||null,s=r.doc,l=s.clientID,o;if(n==null)o=new $([n]);else switch(n.constructor){case Number:case Object:case Boolean:case Array:case String:o=new $([n]);break;case Uint8Array:o=new lt(n);break;case Y:o=new ct(n);break;default:if(n instanceof E)o=new R(n);else throw new Error("Unexpected content type")}new b(m(l,D(s.store,l)),i,i&&i.lastId,null,null,t,e,o).integrate(r,0)},pe=(r,t)=>{let e=r._map.get(t);return e!==void 0&&!e.deleted?e.content.getContent()[e.length-1]:void 0},gn=r=>{let t={};return r._map.forEach((e,n)=>{e.deleted||(t[n]=e.content.getContent()[e.length-1])}),t},fn=(r,t)=>{let e=r._map.get(t);return e!==void 0&&!e.deleted},ii=(r,t,e)=>{let n=r._map.get(t)||null;for(;n!==null&&(!e.sv.has(n.id.client)||n.id.clock>=(e.sv.get(n.id.client)||0));)n=n.left;return n!==null&&nt(n,e)?n.content.getContent()[n.length-1]:void 0},Lt=r=>ht.iteratorFilter(r.entries(),t=>!t[1].deleted),ee=class extends ut{constructor(t,e){super(t,e),this._transaction=e}},J=class extends E{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(t){let e=new J;return e.push(t),e}_integrate(t,e){super._integrate(t,e),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new J}clone(){let t=new J;return t.insert(0,this.toArray().map(e=>e instanceof E?e.clone():e)),t}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}_callObserver(t,e){super._callObserver(t,e),Wt(this,t,new ee(this,t))}insert(t,e){this.doc!==null?S(this.doc,n=>{an(n,this,t,e)}):this._prelimContent.splice(t,0,...e)}push(t){this.doc!==null?S(this.doc,e=>{Pn(e,this,t)}):this._prelimContent.push(...t)}unshift(t){this.insert(0,t)}delete(t,e=1){this.doc!==null?S(this.doc,n=>{un(n,this,t,e)}):this._prelimContent.splice(t,e)}get(t){return dn(this,t)}toArray(){return on(this)}slice(t=0,e=this.length){return ln(this,t,e)}toJSON(){return this.map(t=>t instanceof E?t.toJSON():t)}map(t){return cn(this,t)}forEach(t){Ut(this,t)}[Symbol.iterator](){return Yn(this)}_write(t){t.writeTypeRef(yr)}},tr=r=>new J,ne=class extends ut{constructor(t,e,n){super(t,e),this.keysChanged=n}},z=class extends E{constructor(t){super(),this._prelimContent=null,t===void 0?this._prelimContent=new Map:this._prelimContent=new Map(t)}_integrate(t,e){super._integrate(t,e),this._prelimContent.forEach((n,i)=>{this.set(i,n)}),this._prelimContent=null}_copy(){return new z}clone(){let t=new z;return this.forEach((e,n)=>{t.set(n,e instanceof E?e.clone():e)}),t}_callObserver(t,e){Wt(this,t,new ne(this,t,e))}toJSON(){let t={};return this._map.forEach((e,n)=>{if(!e.deleted){let i=e.content.getContent()[e.length-1];t[n]=i instanceof E?i.toJSON():i}}),t}get size(){return[...Lt(this._map)].length}keys(){return ht.iteratorMap(Lt(this._map),t=>t[0])}values(){return ht.iteratorMap(Lt(this._map),t=>t[1].content.getContent()[t[1].length-1])}entries(){return ht.iteratorMap(Lt(this._map),t=>[t[0],t[1].content.getContent()[t[1].length-1]])}forEach(t){this._map.forEach((e,n)=>{e.deleted||t(e.content.getContent()[e.length-1],n,this)})}[Symbol.iterator](){return this.entries()}delete(t){this.doc!==null?S(this.doc,e=>{zt(e,this,t)}):this._prelimContent.delete(t)}set(t,e){return this.doc!==null?S(this.doc,n=>{fe(n,this,t,e)}):this._prelimContent.set(t,e),e}get(t){return pe(this,t)}has(t){return fn(this,t)}clear(){this.doc!==null?S(this.doc,t=>{this.forEach(function(e,n,i){zt(t,i,n)})}):this._prelimContent.clear()}_write(t){t.writeTypeRef(_r)}},er=r=>new z,q=(r,t)=>r===t||typeof r=="object"&&typeof t=="object"&&r&&t&&Je.equalFlat(r,t),Et=class{constructor(t,e,n,i){this.left=t,this.right=e,this.index=n,this.currentAttributes=i}forward(){switch(this.right===null&&C.unexpectedCase(),this.right.content.constructor){case U:this.right.deleted||wt(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}},xe=(r,t,e)=>{for(;t.right!==null&&e>0;){switch(t.right.content.constructor){case U:t.right.deleted||wt(t.currentAttributes,t.right.content);break;default:t.right.deleted||(e<t.right.length&&V(r,m(t.right.id.client,t.right.id.clock+e)),t.index+=t.right.length,e-=t.right.length);break}t.left=t.right,t.right=t.right.right}return t},xt=(r,t,e)=>{let n=new Map,i=$t(t,e);if(i){let s=new Et(i.p.left,i.p,i.index,n);return xe(r,s,e-i.index)}else{let s=new Et(null,t._start,0,n);return xe(r,s,e)}},pn=(r,t,e,n)=>{for(;e.right!==null&&(e.right.deleted===!0||e.right.content.constructor===U&&q(n.get(e.right.content.key),e.right.content.value));)e.right.deleted||n.delete(e.right.content.key),e.forward();let i=r.doc,s=i.clientID;n.forEach((l,o)=>{let c=e.left,h=e.right,d=new b(m(s,D(i.store,s)),c,c&&c.lastId,h,h&&h.id,t,null,new U(o,l));d.integrate(r,0),e.right=d,e.forward()})},wt=(r,t)=>{let{key:e,value:n}=t;n===null?r.delete(e):r.set(e,n)},wn=(r,t)=>{for(;r.right!==null;){if(!(r.right.deleted||r.right.content.constructor===U&&q(t[r.right.content.key]||null,r.right.content.value)))break;r.forward()}},mn=(r,t,e,n)=>{let i=r.doc,s=i.clientID,l=new Map;for(let o in n){let c=n[o],h=e.currentAttributes.get(o)||null;if(!q(h,c)){l.set(o,h);let{left:d,right:a}=e;e.right=new b(m(s,D(i.store,s)),d,d&&d.lastId,a,a&&a.id,t,null,new U(o,c)),e.right.integrate(r,0),e.forward()}}return l},qt=(r,t,e,n,i)=>{e.currentAttributes.forEach((u,g)=>{i[g]===void 0&&(i[g]=null)});let s=r.doc,l=s.clientID;wn(e,i);let o=mn(r,t,e,i),c=n.constructor===String?new M(n):n instanceof E?new R(n):new K(n),{left:h,right:d,index:a}=e;t._searchMarker&&Dt(t._searchMarker,e.index,c.getLength()),d=new b(m(l,D(s.store,l)),h,h&&h.lastId,d,d&&d.id,t,null,c),d.integrate(r,0),e.right=d,e.index=a,e.forward(),pn(r,t,e,o)},Me=(r,t,e,n,i)=>{let s=r.doc,l=s.clientID;wn(e,i);let o=mn(r,t,e,i);t:for(;e.right!==null&&(n>0||o.size>0&&(e.right.deleted||e.right.content.constructor===U));){if(!e.right.deleted)switch(e.right.content.constructor){case U:{let{key:c,value:h}=e.right.content,d=i[c];if(d!==void 0){if(q(d,h))o.delete(c);else{if(n===0)break t;o.set(c,h)}e.right.delete(r)}else e.currentAttributes.set(c,h);break}default:n<e.right.length&&V(r,m(e.right.id.client,e.right.id.clock+n)),n-=e.right.length;break}e.forward()}if(n>0){let c="";for(;n>0;n--)c+=`
`;e.right=new b(m(l,D(s.store,l)),e.left,e.left&&e.left.lastId,e.right,e.right&&e.right.id,t,null,new M(c)),e.right.integrate(r,0),e.forward()}pn(r,t,e,o)},kn=(r,t,e,n,i)=>{let s=e,l=I.copy(i);for(;s&&(!s.countable||s.deleted);)!s.deleted&&s.content.constructor===U&&wt(l,s.content),s=s.right;let o=0,c=!1;for(;t!==s;){if(e===t&&(c=!0),!t.deleted){let h=t.content;switch(h.constructor){case U:{let{key:d,value:a}=h;((l.get(d)||null)!==a||(n.get(d)||null)===a)&&(t.delete(r),o++,!c&&(i.get(d)||null)===a&&(n.get(d)||null)!==a&&i.delete(d));break}}}t=t.right}return o},nr=(r,t)=>{for(;t&&t.right&&(t.right.deleted||!t.right.countable);)t=t.right;let e=new Set;for(;t&&(t.deleted||!t.countable);){if(!t.deleted&&t.content.constructor===U){let n=t.content.key;e.has(n)?t.delete(r):e.add(n)}t=t.left}},rr=r=>{let t=0;return S(r.doc,e=>{let n=r._start,i=r._start,s=I.create(),l=I.copy(s);for(;i;){if(i.deleted===!1)switch(i.content.constructor){case U:wt(l,i.content);break;default:t+=kn(e,n,i,s,l),s=I.copy(l),n=i;break}i=i.right}}),t},Re=(r,t,e)=>{let n=e,i=I.copy(t.currentAttributes),s=t.right;for(;e>0&&t.right!==null;){if(t.right.deleted===!1)switch(t.right.content.constructor){case R:case K:case M:e<t.right.length&&V(r,m(t.right.id.client,t.right.id.clock+e)),e-=t.right.length,t.right.delete(r);break}t.forward()}s&&kn(r,s,t.right,i,t.currentAttributes);let l=(t.left||t.right).parent;return l._searchMarker&&Dt(l._searchMarker,t.index,-n+e),t},re=class extends ut{constructor(t,e,n){super(t,e),this.childListChanged=!1,this.keysChanged=new Set,n.forEach(i=>{i===null?this.childListChanged=!0:this.keysChanged.add(i)})}get changes(){if(this._changes===null){let t={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=t}return this._changes}get delta(){if(this._delta===null){let t=this.target.doc,e=[];S(t,n=>{let i=new Map,s=new Map,l=this.target._start,o=null,c={},h="",d=0,a=0,u=()=>{if(o!==null){let g;switch(o){case"delete":g={delete:a},a=0;break;case"insert":g={insert:h},i.size>0&&(g.attributes={},i.forEach((w,y)=>{w!==null&&(g.attributes[y]=w)})),h="";break;case"retain":if(g={retain:d},Object.keys(c).length>0){g.attributes={};for(let w in c)g.attributes[w]=c[w]}d=0;break}e.push(g),o=null}};for(;l!==null;){switch(l.content.constructor){case R:case K:this.adds(l)?this.deletes(l)||(u(),o="insert",h=l.content.getContent()[0],u()):this.deletes(l)?(o!=="delete"&&(u(),o="delete"),a+=1):l.deleted||(o!=="retain"&&(u(),o="retain"),d+=1);break;case M:this.adds(l)?this.deletes(l)||(o!=="insert"&&(u(),o="insert"),h+=l.content.str):this.deletes(l)?(o!=="delete"&&(u(),o="delete"),a+=l.length):l.deleted||(o!=="retain"&&(u(),o="retain"),d+=l.length);break;case U:{let{key:g,value:w}=l.content;if(this.adds(l)){if(!this.deletes(l)){let y=i.get(g)||null;q(y,w)?w!==null&&l.delete(n):(o==="retain"&&u(),q(w,s.get(g)||null)?delete c[g]:c[g]=w)}}else if(this.deletes(l)){s.set(g,w);let y=i.get(g)||null;q(y,w)||(o==="retain"&&u(),c[g]=y)}else if(!l.deleted){s.set(g,w);let y=c[g];y!==void 0&&(q(y,w)?y!==null&&l.delete(n):(o==="retain"&&u(),w===null?delete c[g]:c[g]=w))}l.deleted||(o==="insert"&&u(),wt(i,l.content));break}}l=l.right}for(u();e.length>0;){let g=e[e.length-1];if(g.retain!==void 0&&g.attributes===void 0)e.pop();else break}}),this._delta=e}return this._delta}},et=class extends E{constructor(t){super(),this._pending=t!==void 0?[()=>this.insert(0,t)]:[],this._searchMarker=[]}get length(){return this._length}_integrate(t,e){super._integrate(t,e);try{this._pending.forEach(n=>n())}catch(n){console.error(n)}this._pending=null}_copy(){return new et}clone(){let t=new et;return t.applyDelta(this.toDelta()),t}_callObserver(t,e){super._callObserver(t,e);let n=new re(this,t,e),i=t.doc;if(Wt(this,t,n),!t.local){let s=!1;for(let[l,o]of t.afterState.entries()){let c=t.beforeState.get(l)||0;if(o!==c&&(Ze(t,i.store.clients.get(l),c,o,h=>{!h.deleted&&h.content.constructor===U&&(s=!0)}),s))break}s||rt(t,t.deleteSet,l=>{l instanceof O||s||l.parent===this&&l.content.constructor===U&&(s=!0)}),S(i,l=>{s?rr(this):rt(l,l.deleteSet,o=>{o instanceof O||o.parent===this&&nr(l,o)})})}}toString(){let t="",e=this._start;for(;e!==null;)!e.deleted&&e.countable&&e.content.constructor===M&&(t+=e.content.str),e=e.right;return t}toJSON(){return this.toString()}applyDelta(t,{sanitize:e=!0}={}){this.doc!==null?S(this.doc,n=>{let i=new Et(null,this._start,0,new Map);for(let s=0;s<t.length;s++){let l=t[s];if(l.insert!==void 0){let o=!e&&typeof l.insert=="string"&&s===t.length-1&&i.right===null&&l.insert.slice(-1)===`
`?l.insert.slice(0,-1):l.insert;(typeof o!="string"||o.length>0)&&qt(n,this,i,o,l.attributes||{})}else l.retain!==void 0?Me(n,this,i,l.retain,l.attributes||{}):l.delete!==void 0&&Re(n,i,l.delete)}}):this._pending.push(()=>this.applyDelta(t))}toDelta(t,e,n){let i=[],s=new Map,l=this.doc,o="",c=this._start;function h(){if(o.length>0){let d={},a=!1;s.forEach((g,w)=>{a=!0,d[w]=g});let u={insert:o};a&&(u.attributes=d),i.push(u),o=""}}return S(l,d=>{for(t&&Mt(d,t),e&&Mt(d,e);c!==null;){if(nt(c,t)||e!==void 0&&nt(c,e))switch(c.content.constructor){case M:{let a=s.get("ychange");t!==void 0&&!nt(c,t)?(a===void 0||a.user!==c.id.client||a.type!=="removed")&&(h(),s.set("ychange",n?n("removed",c.id):{type:"removed"})):e!==void 0&&!nt(c,e)?(a===void 0||a.user!==c.id.client||a.type!=="added")&&(h(),s.set("ychange",n?n("added",c.id):{type:"added"})):a!==void 0&&(h(),s.delete("ychange")),o+=c.content.str;break}case R:case K:{h();let a={insert:c.content.getContent()[0]};if(s.size>0){let u={};a.attributes=u,s.forEach((g,w)=>{u[w]=g})}i.push(a);break}case U:nt(c,t)&&(h(),wt(s,c.content));break}c=c.right}h()},Mt),i}insert(t,e,n){if(e.length<=0)return;let i=this.doc;i!==null?S(i,s=>{let l=xt(s,this,t);n||(n={},l.currentAttributes.forEach((o,c)=>{n[c]=o})),qt(s,this,l,e,n)}):this._pending.push(()=>this.insert(t,e,n))}insertEmbed(t,e,n={}){let i=this.doc;i!==null?S(i,s=>{let l=xt(s,this,t);qt(s,this,l,e,n)}):this._pending.push(()=>this.insertEmbed(t,e,n))}delete(t,e){if(e===0)return;let n=this.doc;n!==null?S(n,i=>{Re(i,xt(i,this,t),e)}):this._pending.push(()=>this.delete(t,e))}format(t,e,n){if(e===0)return;let i=this.doc;i!==null?S(i,s=>{let l=xt(s,this,t);l.right!==null&&Me(s,this,l,e,n)}):this._pending.push(()=>this.format(t,e,n))}removeAttribute(t){this.doc!==null?S(this.doc,e=>{zt(e,this,t)}):this._pending.push(()=>this.removeAttribute(t))}setAttribute(t,e){this.doc!==null?S(this.doc,n=>{fe(n,this,t,e)}):this._pending.push(()=>this.setAttribute(t,e))}getAttribute(t){return pe(this,t)}getAttributes(t){return gn(this)}_write(t){t.writeTypeRef(br)}},ir=r=>new et,mt=class{constructor(t,e=()=>!0){this._filter=e,this._root=t,this._currentNode=t._start,this._firstCall=!0}[Symbol.iterator](){return this}next(){let t=this._currentNode,e=t&&t.content&&t.content.type;if(t!==null&&(!this._firstCall||t.deleted||!this._filter(e)))do if(e=t.content.type,!t.deleted&&(e.constructor===st||e.constructor===j)&&e._start!==null)t=e._start;else for(;t!==null;)if(t.right!==null){t=t.right;break}else t.parent===this._root?t=null:t=t.parent._item;while(t!==null&&(t.deleted||!this._filter(t.content.type)));return this._firstCall=!1,t===null?{value:void 0,done:!0}:(this._currentNode=t,{value:t.content.type,done:!1})}},j=class extends E{constructor(){super(),this._prelimContent=[]}get firstChild(){let t=this._first;return t?t.content.getContent()[0]:null}_integrate(t,e){super._integrate(t,e),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new j}clone(){let t=new j;return t.insert(0,this.toArray().map(e=>e instanceof E?e.clone():e)),t}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(t){return new mt(this,t)}querySelector(t){t=t.toUpperCase();let n=new mt(this,i=>i.nodeName&&i.nodeName.toUpperCase()===t).next();return n.done?null:n.value}querySelectorAll(t){return t=t.toUpperCase(),Array.from(new mt(this,e=>e.nodeName&&e.nodeName.toUpperCase()===t))}_callObserver(t,e){Wt(this,t,new ie(this,e,t))}toString(){return cn(this,t=>t.toString()).join("")}toJSON(){return this.toString()}toDOM(t=document,e={},n){let i=t.createDocumentFragment();return n!==void 0&&n._createAssociation(i,this),Ut(this,s=>{i.insertBefore(s.toDOM(t,e,n),null)}),i}insert(t,e){this.doc!==null?S(this.doc,n=>{an(n,this,t,e)}):this._prelimContent.splice(t,0,...e)}insertAfter(t,e){if(this.doc!==null)S(this.doc,n=>{let i=t&&t instanceof E?t._item:t;Ht(n,this,i,e)});else{let n=this._prelimContent,i=t===null?0:n.findIndex(s=>s===t)+1;if(i===0&&t!==null)throw C.create("Reference item not found");n.splice(i,0,...e)}}delete(t,e=1){this.doc!==null?S(this.doc,n=>{un(n,this,t,e)}):this._prelimContent.splice(t,e)}toArray(){return on(this)}push(t){this.insert(this.length,t)}unshift(t){this.insert(0,t)}get(t){return dn(this,t)}slice(t=0,e=this.length){return ln(this,t,e)}forEach(t){Ut(this,t)}_write(t){t.writeTypeRef(Cr)}},sr=r=>new j,st=class extends j{constructor(t="UNDEFINED"){super(),this.nodeName=t,this._prelimAttrs=new Map}get nextSibling(){let t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){let t=this._item?this._item.prev:null;return t?t.content.type:null}_integrate(t,e){super._integrate(t,e),this._prelimAttrs.forEach((n,i)=>{this.setAttribute(i,n)}),this._prelimAttrs=null}_copy(){return new st(this.nodeName)}clone(){let t=new st(this.nodeName),e=this.getAttributes();for(let n in e)t.setAttribute(n,e[n]);return t.insert(0,this.toArray().map(n=>n instanceof E?n.clone():n)),t}toString(){let t=this.getAttributes(),e=[],n=[];for(let o in t)n.push(o);n.sort();let i=n.length;for(let o=0;o<i;o++){let c=n[o];e.push(c+'="'+t[c]+'"')}let s=this.nodeName.toLocaleLowerCase(),l=e.length>0?" "+e.join(" "):"";return`<${s}${l}>${super.toString()}</${s}>`}removeAttribute(t){this.doc!==null?S(this.doc,e=>{zt(e,this,t)}):this._prelimAttrs.delete(t)}setAttribute(t,e){this.doc!==null?S(this.doc,n=>{fe(n,this,t,e)}):this._prelimAttrs.set(t,e)}getAttribute(t){return pe(this,t)}hasAttribute(t){return fn(this,t)}getAttributes(t){return gn(this)}toDOM(t=document,e={},n){let i=t.createElement(this.nodeName),s=this.getAttributes();for(let l in s)i.setAttribute(l,s[l]);return Ut(this,l=>{i.appendChild(l.toDOM(t,e,n))}),n!==void 0&&n._createAssociation(i,this),i}_write(t){t.writeTypeRef(Sr),t.writeKey(this.nodeName)}},lr=r=>new st(r.readKey()),ie=class extends ut{constructor(t,e,n){super(t,n),this.childListChanged=!1,this.attributesChanged=new Set,e.forEach(i=>{i===null?this.childListChanged=!0:this.attributesChanged.add(i)})}},gt=class extends z{constructor(t){super(),this.hookName=t}_copy(){return new gt(this.hookName)}clone(){let t=new gt(this.hookName);return this.forEach((e,n)=>{t.set(n,e)}),t}toDOM(t=document,e={},n){let i=e[this.hookName],s;return i!==void 0?s=i.createDom(this):s=document.createElement(this.hookName),s.setAttribute("data-yjs-hook",this.hookName),n!==void 0&&n._createAssociation(s,this),s}_write(t){t.writeTypeRef(Dr),t.writeKey(this.hookName)}},or=r=>new gt(r.readKey()),ft=class extends et{get nextSibling(){let t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){let t=this._item?this._item.prev:null;return t?t.content.type:null}_copy(){return new ft}clone(){let t=new ft;return t.applyDelta(this.toDelta()),t}toDOM(t=document,e,n){let i=t.createTextNode(this.toString());return n!==void 0&&n._createAssociation(i,this),i}toString(){return this.toDelta().map(t=>{let e=[];for(let i in t.attributes){let s=[];for(let l in t.attributes[i])s.push({key:l,value:t.attributes[i][l]});s.sort((l,o)=>l.key<o.key?-1:1),e.push({nodeName:i,attrs:s})}e.sort((i,s)=>i.nodeName<s.nodeName?-1:1);let n="";for(let i=0;i<e.length;i++){let s=e[i];n+=`<${s.nodeName}`;for(let l=0;l<s.attrs.length;l++){let o=s.attrs[l];n+=` ${o.key}="${o.value}"`}n+=">"}n+=t.insert;for(let i=e.length-1;i>=0;i--)n+=`</${e[i].nodeName}>`;return n}).join("")}toJSON(){return this.toString()}_write(t){t.writeTypeRef(Ur)}},cr=r=>new ft,It=class{constructor(t,e){this.id=t,this.length=e}get deleted(){throw C.methodUnimplemented()}mergeWith(t){return!1}write(t,e,n){throw C.methodUnimplemented()}integrate(t,e){throw C.methodUnimplemented()}},dr=0,O=class extends It{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor!==t.constructor?!1:(this.length+=t.length,!0)}integrate(t,e){e>0&&(this.id.clock+=e,this.length-=e),Qe(t.doc.store,this)}write(t,e){t.writeInfo(dr),t.writeLen(this.length-e)}getMissing(t,e){return null}},lt=class{constructor(t){this.content=t}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new lt(this.content)}splice(t){throw C.methodUnimplemented()}mergeWith(t){return!1}integrate(t,e){}delete(t){}gc(t){}write(t,e){t.writeBuf(this.content)}getRef(){return 3}},hr=r=>new lt(r.readBuf()),ot=class{constructor(t){this.len=t}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new ot(this.len)}splice(t){let e=new ot(this.len-t);return this.len=t,e}mergeWith(t){return this.len+=t.len,!0}integrate(t,e){bt(t.deleteSet,e.id.client,e.id.clock,this.len),e.markDeleted()}delete(t){}gc(t){}write(t,e){t.writeLen(this.len-e)}getRef(){return 1}},ar=r=>new ot(r.readLen()),yn=(r,t)=>new Y({guid:r,...t,shouldLoad:t.shouldLoad||t.autoLoad||!1}),ct=class{constructor(t){t._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=t;let e={};this.opts=e,t.gc||(e.gc=!1),t.autoLoad&&(e.autoLoad=!0),t.meta!==null&&(e.meta=t.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new ct(yn(this.doc.guid,this.opts))}splice(t){throw C.methodUnimplemented()}mergeWith(t){return!1}integrate(t,e){this.doc._item=e,t.subdocsAdded.add(this.doc),this.doc.shouldLoad&&t.subdocsLoaded.add(this.doc)}delete(t){t.subdocsAdded.has(this.doc)?t.subdocsAdded.delete(this.doc):t.subdocsRemoved.add(this.doc)}gc(t){}write(t,e){t.writeString(this.doc.guid),t.writeAny(this.opts)}getRef(){return 9}},ur=r=>new ct(yn(r.readString(),r.readAny())),K=class{constructor(t){this.embed=t}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new K(this.embed)}splice(t){throw C.methodUnimplemented()}mergeWith(t){return!1}integrate(t,e){}delete(t){}gc(t){}write(t,e){t.writeJSON(this.embed)}getRef(){return 5}},gr=r=>new K(r.readJSON()),U=class{constructor(t,e){this.key=t,this.value=e}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new U(this.key,this.value)}splice(t){throw C.methodUnimplemented()}mergeWith(t){return!1}integrate(t,e){e.parent._searchMarker=null}delete(t){}gc(t){}write(t,e){t.writeKey(this.key),t.writeJSON(this.value)}getRef(){return 6}},fr=r=>new U(r.readKey(),r.readJSON()),pt=class{constructor(t){this.arr=t}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new pt(this.arr)}splice(t){let e=new pt(this.arr.slice(t));return this.arr=this.arr.slice(0,t),e}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,e){}delete(t){}gc(t){}write(t,e){let n=this.arr.length;t.writeLen(n-e);for(let i=e;i<n;i++){let s=this.arr[i];t.writeString(s===void 0?"undefined":JSON.stringify(s))}}getRef(){return 2}},pr=r=>{let t=r.readLen(),e=[];for(let n=0;n<t;n++){let i=r.readString();i==="undefined"?e.push(void 0):e.push(JSON.parse(i))}return new pt(e)},$=class{constructor(t){this.arr=t}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new $(this.arr)}splice(t){let e=new $(this.arr.slice(t));return this.arr=this.arr.slice(0,t),e}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,e){}delete(t){}gc(t){}write(t,e){let n=this.arr.length;t.writeLen(n-e);for(let i=e;i<n;i++){let s=this.arr[i];t.writeAny(s)}}getRef(){return 8}},wr=r=>{let t=r.readLen(),e=[];for(let n=0;n<t;n++)e.push(r.readAny());return new $(e)},M=class{constructor(t){this.str=t}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new M(this.str)}splice(t){let e=new M(this.str.slice(t));this.str=this.str.slice(0,t);let n=this.str.charCodeAt(t-1);return n>=55296&&n<=56319&&(this.str=this.str.slice(0,t-1)+"\uFFFD",e.str="\uFFFD"+e.str.slice(1)),e}mergeWith(t){return this.str+=t.str,!0}integrate(t,e){}delete(t){}gc(t){}write(t,e){t.writeString(e===0?this.str:this.str.slice(e))}getRef(){return 4}},mr=r=>new M(r.readString()),kr=[tr,er,ir,lr,sr,or,cr],yr=0,_r=1,br=2,Sr=3,Cr=4,Dr=5,Ur=6,R=class{constructor(t){this.type=t}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new R(this.type._copy())}splice(t){throw C.methodUnimplemented()}mergeWith(t){return!1}integrate(t,e){this.type._integrate(t.doc,e)}delete(t){let e=this.type._start;for(;e!==null;)e.deleted?t._mergeStructs.push(e):e.delete(t),e=e.right;this.type._map.forEach(n=>{n.deleted?t._mergeStructs.push(n):n.delete(t)}),t.changed.delete(this.type)}gc(t){let e=this.type._start;for(;e!==null;)e.gc(t,!0),e=e.right;this.type._start=null,this.type._map.forEach(n=>{for(;n!==null;)n.gc(t,!0),n=n.left}),this.type._map=new Map}write(t,e){this.type._write(t)}getRef(){return 7}},Er=r=>new R(kr[r.readTypeRef()](r)),se=(r,t)=>{let e=t,n=0,i;do n>0&&(e=m(e.client,e.clock+n)),i=Rt(r,e),n=e.clock-i.id.clock,e=i.redone;while(e!==null&&i instanceof b);return{item:i,diff:n}},we=(r,t)=>{for(;r!==null&&r.keep!==t;)r.keep=t,r=r.parent._item},jt=(r,t,e)=>{let{client:n,clock:i}=t.id,s=new b(m(n,i+e),t,m(n,i+e-1),t.right,t.rightOrigin,t.parent,t.parentSub,t.content.splice(e));return t.deleted&&s.markDeleted(),t.keep&&(s.keep=!0),t.redone!==null&&(s.redone=m(t.redone.client,t.redone.clock+e)),t.right=s,s.right!==null&&(s.right.left=s),r._mergeStructs.push(s),s.parentSub!==null&&s.right===null&&s.parent._map.set(s.parentSub,s),t.length=e,s},_n=(r,t,e,n,i)=>{let s=r.doc,l=s.store,o=s.clientID,c=t.redone;if(c!==null)return V(r,c);let h=t.parent._item,d=null,a;if(h!==null&&h.deleted===!0){if(h.redone===null&&(!e.has(h)||_n(r,h,e,n,i)===null))return null;for(;h.redone!==null;)h=V(r,h.redone)}let u=h===null?t.parent:h.content.type;if(t.parentSub===null){for(d=t.left,a=t;d!==null;){let _=d;for(;_!==null&&_.parent._item!==h;)_=_.redone===null?null:V(r,_.redone);if(_!==null&&_.parent._item===h){d=_;break}d=d.left}for(;a!==null;){let _=a;for(;_!==null&&_.parent._item!==h;)_=_.redone===null?null:V(r,_.redone);if(_!==null&&_.parent._item===h){a=_;break}a=a.right}}else if(a=null,t.right&&!i){for(d=t;d!==null&&d.right!==null&&At(n,d.right.id);)d=d.right;for(;d!==null&&d.redone!==null;)d=V(r,d.redone);if(d&&d.right!==null)return null}else d=u._map.get(t.parentSub)||null;let g=D(l,o),w=m(o,g),y=new b(w,d,d&&d.lastId,a,a&&a.id,u,t.parentSub,t.content.copy());return t.redone=w,we(y,!0),y.integrate(r,0),y},b=class extends It{constructor(t,e,n,i,s,l,o,c){super(t,c.getLength()),this.origin=n,this.left=e,this.right=i,this.rightOrigin=s,this.parent=l,this.parentSub=o,this.redone=null,this.content=c,this.info=this.content.isCountable()?k.BIT2:0}set marker(t){(this.info&k.BIT4)>0!==t&&(this.info^=k.BIT4)}get marker(){return(this.info&k.BIT4)>0}get keep(){return(this.info&k.BIT1)>0}set keep(t){this.keep!==t&&(this.info^=k.BIT1)}get countable(){return(this.info&k.BIT2)>0}get deleted(){return(this.info&k.BIT3)>0}set deleted(t){this.deleted!==t&&(this.info^=k.BIT3)}markDeleted(){this.info|=k.BIT3}getMissing(t,e){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=D(e,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=D(e,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===Q&&this.id.client!==this.parent.client&&this.parent.clock>=D(e,this.parent.client))return this.parent.client;if(this.origin&&(this.left=Ie(t,e,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=V(t,this.rightOrigin),this.rightOrigin=this.right.id),(this.left&&this.left.constructor===O||this.right&&this.right.constructor===O)&&(this.parent=null),!this.parent)this.left&&this.left.constructor===b&&(this.parent=this.left.parent,this.parentSub=this.left.parentSub),this.right&&this.right.constructor===b&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===Q){let n=Rt(e,this.parent);n.constructor===O?this.parent=null:this.parent=n.content.type}return null}integrate(t,e){if(e>0&&(this.id.clock+=e,this.left=Ie(t,t.doc.store,m(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(e),this.length-=e),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let n=this.left,i;if(n!==null)i=n.right;else if(this.parentSub!==null)for(i=this.parent._map.get(this.parentSub)||null;i!==null&&i.left!==null;)i=i.left;else i=this.parent._start;let s=new Set,l=new Set;for(;i!==null&&i!==this.right;){if(l.add(i),s.add(i),dt(this.origin,i.origin)){if(i.id.client<this.id.client)n=i,s.clear();else if(dt(this.rightOrigin,i.rightOrigin))break}else if(i.origin!==null&&l.has(Rt(t.doc.store,i.origin)))s.has(Rt(t.doc.store,i.origin))||(n=i,s.clear());else break;i=i.right}this.left=n}if(this.left!==null){let n=this.left.right;this.right=n,this.left.right=this}else{let n;if(this.parentSub!==null)for(n=this.parent._map.get(this.parentSub)||null;n!==null&&n.left!==null;)n=n.left;else n=this.parent._start,this.parent._start=this;this.right=n}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(t)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),Qe(t.doc.store,this),this.content.integrate(t,this),Ve(t,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(t)}else new O(this.id,this.length).integrate(t,0)}get next(){let t=this.right;for(;t!==null&&t.deleted;)t=t.right;return t}get prev(){let t=this.left;for(;t!==null&&t.deleted;)t=t.left;return t}get lastId(){return this.length===1?this.id:m(this.id.client,this.id.clock+this.length-1)}mergeWith(t){if(this.constructor===t.constructor&&dt(t.origin,this.lastId)&&this.right===t&&dt(this.rightOrigin,t.rightOrigin)&&this.id.client===t.id.client&&this.id.clock+this.length===t.id.clock&&this.deleted===t.deleted&&this.redone===null&&t.redone===null&&this.content.constructor===t.content.constructor&&this.content.mergeWith(t.content)){let e=this.parent._searchMarker;return e&&e.forEach(n=>{n.p===t&&(n.p=this,!this.deleted&&this.countable&&(n.index-=this.length))}),t.keep&&(this.keep=!0),this.right=t.right,this.right!==null&&(this.right.left=this),this.length+=t.length,!0}return!1}delete(t){if(!this.deleted){let e=this.parent;this.countable&&this.parentSub===null&&(e._length-=this.length),this.markDeleted(),bt(t.deleteSet,this.id.client,this.id.clock,this.length),Ve(t,e,this.parentSub),this.content.delete(t)}}gc(t,e){if(!this.deleted)throw C.unexpectedCase();this.content.gc(t),e?Jn(t,this,new O(this.id,this.length)):this.content=new ot(this.length)}write(t,e){let n=e>0?m(this.id.client,this.id.clock+e-1):this.origin,i=this.rightOrigin,s=this.parentSub,l=this.content.getRef()&k.BITS5|(n===null?0:k.BIT8)|(i===null?0:k.BIT7)|(s===null?0:k.BIT6);if(t.writeInfo(l),n!==null&&t.writeLeftID(n),i!==null&&t.writeRightID(i),n===null&&i===null){let o=this.parent;if(o._item!==void 0){let c=o._item;if(c===null){let h=We(o);t.writeParentInfo(!0),t.writeString(h)}else t.writeParentInfo(!1),t.writeLeftID(c.id)}else o.constructor===String?(t.writeParentInfo(!0),t.writeString(o)):o.constructor===Q?(t.writeParentInfo(!1),t.writeLeftID(o)):C.unexpectedCase();s!==null&&t.writeString(s)}this.content.write(t,e)}},bn=(r,t)=>Ir[t&k.BITS5](r),Ir=[()=>{C.unexpectedCase()},ar,pr,hr,mr,gr,fr,Er,wr,ur,()=>{C.unexpectedCase()}],Ar=10,T=class extends It{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor!==t.constructor?!1:(this.length+=t.length,!0)}integrate(t,e){C.unexpectedCase()}write(t,e){t.writeInfo(Ar),f.writeVarUint(t.restEncoder,this.length-e)}getMissing(t,e){return null}},Sn=typeof globalThis<"u"?globalThis:typeof document<"u"?window:typeof __global$<"u"?__global$:{},Cn="__ $YJS$ __";Sn[Cn]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438");Sn[Cn]=!0;export{Zt as AbsolutePosition,ye as AbstractConnector,It as AbstractStruct,E as AbstractType,J as Array,$ as ContentAny,lt as ContentBinary,ot as ContentDeleted,K as ContentEmbed,U as ContentFormat,pt as ContentJSON,M as ContentString,R as ContentType,Y as Doc,O as GC,Q as ID,b as Item,z as Map,Ee as PermanentUserData,St as RelativePosition,Ft as Snapshot,et as Text,Yt as Transaction,Le as UndoManager,tt as UpdateEncoderV1,st as XmlElement,j as XmlFragment,gt as XmlHook,ft as XmlText,ee as YArrayEvent,ut as YEvent,ne as YMapEvent,re as YTextEvent,ie as YXmlEvent,Lr as applyUpdate,he as applyUpdateV2,rr as cleanupYTextFormatting,dt as compareIDs,Hr as compareRelativePositions,ei as convertUpdateFormatV1ToV2,qn as convertUpdateFormatV2ToV1,Gr as createAbsolutePositionFromRelativePosition,ce as createDeleteSet,Ge as createDeleteSetFromStructStore,qr as createDocFromSnapshot,m as createID,Nr as createRelativePositionFromJSON,Br as createRelativePositionFromTypeIndex,qe as createSnapshot,Jr as decodeRelativePosition,Kr as decodeSnapshot,Bn as decodeSnapshotV2,Ke as decodeStateVector,Xr as decodeUpdate,zn as decodeUpdateV2,ti as diffUpdate,tn as diffUpdateV2,$r as emptySnapshot,Fr as encodeRelativePosition,jr as encodeSnapshot,Nn as encodeSnapshotV2,xr as encodeStateAsUpdate,On as encodeStateAsUpdateV2,Mr as encodeStateVector,Yr as encodeStateVectorFromUpdate,Kn as encodeStateVectorFromUpdateV2,zr as equalSnapshots,F as findIndexSS,We as findRootTypeKey,Rt as getItem,D as getState,ni as getTypeChildren,At as isDeleted,Bt as isParentOf,rt as iterateDeletedStructs,Rr as logType,Zr as logUpdate,Hn as logUpdateV2,jn as mergeUpdates,Gt as mergeUpdatesV2,Pr as parseUpdateMeta,$n as parseUpdateMetaV2,Or as readUpdate,ze as readUpdateV2,vr as relativePositionToJSON,Wr as snapshot,S as transact,Qr as tryGc,ri as typeListToArraySnapshot,ii as typeMapGetSnapshot};
//# sourceMappingURL=yjs.mjs.map