/* esm.sh - esbuild bundle(@codemirror/search@6.2.3) deno production */
import{showPanel as se,EditorView as S,getPanel as D,Decoration as f,ViewPlugin as le,runScopeHandlers as pe}from"@codemirror/view";import{codePointAt as ge,fromCodePoint as xe,codePointSize as ve,StateEffect as W,StateField as oe,EditorSelection as y,Facet as ce,combineConfig as ae,CharCategory as m,RangeSetBuilder as ye,Prec as Me,EditorState as Se,findClusterBreak as he}from"@codemirror/state";import a from"/v119/crelt@1.0.5/X-ZS9AY29kZW1pcnJvci9zdGF0ZSxAY29kZW1pcnJvci92aWV3/deno/crelt.mjs";var te=typeof String.prototype.normalize=="function"?n=>n.normalize("NFKD"):n=>n,M=class{constructor(e,t,r=0,i=e.length,s,l){this.test=l,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(r,i),this.bufferStart=r,this.normalize=s?o=>s(te(o)):te,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return ge(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let t=xe(e),r=this.bufferStart+this.bufferPos;this.bufferPos+=ve(e);let i=this.normalize(t);for(let s=0,l=r;;s++){let o=i.charCodeAt(s),c=this.match(o,l);if(c)return this.value=c,this;if(s==i.length-1)break;l==r&&s<t.length&&t.charCodeAt(s)==o&&l++}}}match(e,t){let r=null;for(let i=0;i<this.matches.length;i+=2){let s=this.matches[i],l=!1;this.query.charCodeAt(s)==e&&(s==this.query.length-1?r={from:this.matches[i+1],to:t+1}:(this.matches[i]++,l=!0)),l||(this.matches.splice(i,2),i-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?r={from:t,to:t+1}:this.matches.push(1,t)),r&&this.test&&!this.test(r.from,r.to,this.buffer,this.bufferPos)&&(r=null),r}};typeof Symbol<"u"&&(M.prototype[Symbol.iterator]=function(){return this});var ue={from:-1,to:-1,match:/.*/.exec("")},U="gm"+(/x/.unicode==null?"":"u"),q=class{constructor(e,t,r,i=0,s=e.length){if(this.text=e,this.to=s,this.curLine="",this.done=!1,this.value=ue,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new E(e,t,r,i,s);this.re=new RegExp(t,U+(r?.ignoreCase?"i":"")),this.test=r?.test,this.iter=e.iter();let l=e.lineAt(i);this.curLineStart=l.from,this.matchPos=P(e,i),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let r=this.curLineStart+t.index,i=r+t[0].length;if(this.matchPos=P(this.text,i+(r==i?1:0)),r==this.curLineStart+this.curLine.length&&this.nextLine(),(r<i||r>this.value.to)&&(!this.test||this.test(r,i,t)))return this.value={from:r,to:i,match:t},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}},H=new WeakMap,v=class{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,r){let i=H.get(e);if(!i||i.from>=r||i.to<=t){let o=new v(t,e.sliceString(t,r));return H.set(e,o),o}if(i.from==t&&i.to==r)return i;let{text:s,from:l}=i;return l>t&&(s=e.sliceString(t,l)+s,l=t),i.to<r&&(s+=e.sliceString(i.to,r)),H.set(e,new v(l,s)),new v(t,s.slice(t-l,r-l))}},E=class{constructor(e,t,r,i,s){this.text=e,this.to=s,this.done=!1,this.value=ue,this.matchPos=P(e,i),this.re=new RegExp(t,U+(r?.ignoreCase?"i":"")),this.test=r?.test,this.flat=v.get(e,i,this.chunkEnd(i+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t){let r=this.flat.from+t.index,i=r+t[0].length;if((this.flat.to>=this.to||t.index+t[0].length<=this.flat.text.length-10)&&(!this.test||this.test(r,i,t)))return this.value={from:r,to:i,match:t},this.matchPos=P(this.text,i+(r==i?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=v.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}};typeof Symbol<"u"&&(q.prototype[Symbol.iterator]=E.prototype[Symbol.iterator]=function(){return this});function be(n){try{return new RegExp(n,U),!0}catch{return!1}}function P(n,e){if(e>=n.length)return e;let t=n.lineAt(e),r;for(;e<t.to&&(r=t.text.charCodeAt(e-t.from))>=56320&&r<57344;)e++;return e}function K(n){let e=a("input",{class:"cm-textfield",name:"line"}),t=a("form",{class:"cm-gotoLine",onkeydown:i=>{i.keyCode==27?(i.preventDefault(),n.dispatch({effects:R.of(!1)}),n.focus()):i.keyCode==13&&(i.preventDefault(),r())},onsubmit:i=>{i.preventDefault(),r()}},a("label",n.state.phrase("Go to line"),": ",e)," ",a("button",{class:"cm-button",type:"submit"},n.state.phrase("go")));function r(){let i=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(e.value);if(!i)return;let{state:s}=n,l=s.doc.lineAt(s.selection.main.head),[,o,c,d,h]=i,g=d?+d.slice(1):0,x=c?+c:l.number;if(c&&h){let N=x/100;o&&(N=N*(o=="-"?-1:1)+l.number/s.doc.lines),x=Math.round(s.doc.lines*N)}else c&&o&&(x=x*(o=="-"?-1:1)+l.number);let ee=s.doc.line(Math.max(1,Math.min(s.doc.lines,x)));n.dispatch({effects:R.of(!1),selection:y.cursor(ee.from+Math.max(0,Math.min(g,ee.length))),scrollIntoView:!0}),n.focus()}return{dom:t}}var R=W.define(),ne=oe.define({create(){return!0},update(n,e){for(let t of e.effects)t.is(R)&&(n=t.value);return n},provide:n=>se.from(n,e=>e?K:null)}),ke=n=>{let e=D(n,K);if(!e){let t=[R.of(!0)];n.state.field(ne,!1)==null&&t.push(W.appendConfig.of([ne,Ce])),n.dispatch({effects:t}),e=D(n,K)}return e&&e.dom.querySelector("input").focus(),!0},Ce=S.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),Le={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},fe=ce.define({combine(n){return ae(n,Le,{highlightWordAroundCursor:(e,t)=>e||t,minSelectionLength:Math.min,maxMatches:Math.min})}});function Ge(n){let e=[De,we];return n&&e.push(fe.of(n)),e}var We=f.mark({class:"cm-selectionMatch"}),Ae=f.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function re(n,e,t,r){return(t==0||n(e.sliceDoc(t-1,t))!=m.Word)&&(r==e.doc.length||n(e.sliceDoc(r,r+1))!=m.Word)}function Fe(n,e,t,r){return n(e.sliceDoc(t,t+1))==m.Word&&n(e.sliceDoc(r-1,r))==m.Word}var we=le.fromClass(class{constructor(n){this.decorations=this.getDeco(n)}update(n){(n.selectionSet||n.docChanged||n.viewportChanged)&&(this.decorations=this.getDeco(n.view))}getDeco(n){let e=n.state.facet(fe),{state:t}=n,r=t.selection;if(r.ranges.length>1)return f.none;let i=r.main,s,l=null;if(i.empty){if(!e.highlightWordAroundCursor)return f.none;let c=t.wordAt(i.head);if(!c)return f.none;l=t.charCategorizer(i.head),s=t.sliceDoc(c.from,c.to)}else{let c=i.to-i.from;if(c<e.minSelectionLength||c>200)return f.none;if(e.wholeWords){if(s=t.sliceDoc(i.from,i.to),l=t.charCategorizer(i.head),!(re(l,t,i.from,i.to)&&Fe(l,t,i.from,i.to)))return f.none}else if(s=t.sliceDoc(i.from,i.to).trim(),!s)return f.none}let o=[];for(let c of n.visibleRanges){let d=new M(t.doc,s,c.from,c.to);for(;!d.next().done;){let{from:h,to:g}=d.value;if((!l||re(l,t,h,g))&&(i.empty&&h<=i.from&&g>=i.to?o.push(Ae.range(h,g)):(h>=i.to||g<=i.from)&&o.push(We.range(h,g)),o.length>e.maxMatches))return f.none}}return f.set(o)}},{decorations:n=>n.decorations}),De=S.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),qe=({state:n,dispatch:e})=>{let{selection:t}=n,r=y.create(t.ranges.map(i=>n.wordAt(i.head)||y.cursor(i.head)),t.mainIndex);return r.eq(t)?!1:(e(n.update({selection:r})),!0)};function Ee(n,e){let{main:t,ranges:r}=n.selection,i=n.wordAt(t.head),s=i&&i.from==t.from&&i.to==t.to;for(let l=!1,o=new M(n.doc,e,r[r.length-1].to);;)if(o.next(),o.done){if(l)return null;o=new M(n.doc,e,0,Math.max(0,r[r.length-1].from-1)),l=!0}else{if(l&&r.some(c=>c.from==o.value.from))continue;if(s){let c=n.wordAt(o.value.from);if(!c||c.from!=o.value.from||c.to!=o.value.to)continue}return o.value}}var Pe=({state:n,dispatch:e})=>{let{ranges:t}=n.selection;if(t.some(s=>s.from===s.to))return qe({state:n,dispatch:e});let r=n.sliceDoc(t[0].from,t[0].to);if(n.selection.ranges.some(s=>n.sliceDoc(s.from,s.to)!=r))return!1;let i=Ee(n,r);return i?(e(n.update({selection:n.selection.addRange(y.range(i.from,i.to),!1),effects:S.scrollIntoView(i.to)})),!0):!1},B=ce.define({combine(n){return ae(n,{top:!1,caseSensitive:!1,literal:!1,wholeWord:!1,createPanel:e=>new j(e)})}});function Qe(n){return n?[B.of(n),J]:J}var I=class{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||be(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(t,r)=>r=="n"?`
`:r=="r"?"\r":r=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new Q(this):new G(this)}getCursor(e,t=0,r){let i=e.doc?e:Se.create({doc:e});return r==null&&(r=i.doc.length),this.regexp?k(this,i,t,r):b(this,i,t,r)}},O=class{constructor(e){this.spec=e}};function b(n,e,t,r){return new M(e.doc,n.unquoted,t,r,n.caseSensitive?void 0:i=>i.toLowerCase(),n.wholeWord?Re(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function Re(n,e){return(t,r,i,s)=>((s>t||s+i.length<r)&&(s=Math.max(0,t-2),i=n.sliceString(s,Math.min(n.length,r+2))),(e($(i,t-s))!=m.Word||e(T(i,t-s))!=m.Word)&&(e(T(i,r-s))!=m.Word||e($(i,r-s))!=m.Word))}var G=class extends O{constructor(e){super(e)}nextMatch(e,t,r){let i=b(this.spec,e,r,e.doc.length).nextOverlapping();return i.done&&(i=b(this.spec,e,0,t).nextOverlapping()),i.done?null:i.value}prevMatchInRange(e,t,r){for(let i=r;;){let s=Math.max(t,i-1e4-this.spec.unquoted.length),l=b(this.spec,e,s,i),o=null;for(;!l.nextOverlapping().done;)o=l.value;if(o)return o;if(s==t)return null;i-=1e4}}prevMatch(e,t,r){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,r,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,t){let r=b(this.spec,e,0,e.doc.length),i=[];for(;!r.next().done;){if(i.length>=t)return null;i.push(r.value)}return i}highlight(e,t,r,i){let s=b(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(r+this.spec.unquoted.length,e.doc.length));for(;!s.next().done;)i(s.value.from,s.value.to)}};function k(n,e,t,r){return new q(e.doc,n.search,{ignoreCase:!n.caseSensitive,test:n.wholeWord?Ie(e.charCategorizer(e.selection.main.head)):void 0},t,r)}function $(n,e){return n.slice(he(n,e,!1),e)}function T(n,e){return n.slice(e,he(n,e))}function Ie(n){return(e,t,r)=>!r[0].length||(n($(r.input,r.index))!=m.Word||n(T(r.input,r.index))!=m.Word)&&(n(T(r.input,r.index+r[0].length))!=m.Word||n($(r.input,r.index+r[0].length))!=m.Word)}var Q=class extends O{nextMatch(e,t,r){let i=k(this.spec,e,r,e.doc.length).next();return i.done&&(i=k(this.spec,e,0,t).next()),i.done?null:i.value}prevMatchInRange(e,t,r){for(let i=1;;i++){let s=Math.max(t,r-i*1e4),l=k(this.spec,e,s,r),o=null;for(;!l.next().done;)o=l.value;if(o&&(s==t||o.from>s+10))return o;if(s==t)return null}}prevMatch(e,t,r){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,r,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace.replace(/\$([$&\d+])/g,(t,r)=>r=="$"?"$":r=="&"?e.match[0]:r!="0"&&+r<e.match.length?e.match[r]:t))}matchAll(e,t){let r=k(this.spec,e,0,e.doc.length),i=[];for(;!r.next().done;){if(i.length>=t)return null;i.push(r.value)}return i}highlight(e,t,r,i){let s=k(this.spec,e,Math.max(0,t-250),Math.min(r+250,e.doc.length));for(;!s.next().done;)i(s.value.from,s.value.to)}},L=W.define(),X=W.define(),p=oe.define({create(n){return new C(_(n).create(),null)},update(n,e){for(let t of e.effects)t.is(L)?n=new C(t.value.create(),n.panel):t.is(X)&&(n=new C(n.query,t.value?Y:null));return n},provide:n=>se.from(n,e=>e.panel)});function je(n){let e=n.field(p,!1);return e?e.query.spec:_(n)}function Je(n){var e;return((e=n.field(p,!1))===null||e===void 0?void 0:e.panel)!=null}var C=class{constructor(e,t){this.query=e,this.panel=t}},Oe=f.mark({class:"cm-searchMatch"}),$e=f.mark({class:"cm-searchMatch cm-searchMatch-selected"}),Te=le.fromClass(class{constructor(n){this.view=n,this.decorations=this.highlight(n.state.field(p))}update(n){let e=n.state.field(p);(e!=n.startState.field(p)||n.docChanged||n.selectionSet||n.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:n,panel:e}){if(!e||!n.spec.valid)return f.none;let{view:t}=this,r=new ye;for(let i=0,s=t.visibleRanges,l=s.length;i<l;i++){let{from:o,to:c}=s[i];for(;i<l-1&&c>s[i+1].from-2*250;)c=s[++i].to;n.highlight(t.state,o,c,(d,h)=>{let g=t.state.selection.ranges.some(x=>x.from==d&&x.to==h);r.add(d,h,g?$e:Oe)})}return r.finish()}},{decorations:n=>n.decorations});function A(n){return e=>{let t=e.state.field(p,!1);return t&&t.query.spec.valid?n(e,t):de(e)}}var z=A((n,{query:e})=>{let{to:t}=n.state.selection.main,r=e.nextMatch(n.state,t,t);return r?(n.dispatch({selection:{anchor:r.from,head:r.to},scrollIntoView:!0,effects:Z(n,r),userEvent:"select.search"}),!0):!1}),V=A((n,{query:e})=>{let{state:t}=n,{from:r}=t.selection.main,i=e.prevMatch(t,r,r);return i?(n.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0,effects:Z(n,i),userEvent:"select.search"}),!0):!1}),ze=A((n,{query:e})=>{let t=e.matchAll(n.state,1e3);return!t||!t.length?!1:(n.dispatch({selection:y.create(t.map(r=>y.range(r.from,r.to))),userEvent:"select.search.matches"}),!0)}),Ve=({state:n,dispatch:e})=>{let t=n.selection;if(t.ranges.length>1||t.main.empty)return!1;let{from:r,to:i}=t.main,s=[],l=0;for(let o=new M(n.doc,n.sliceDoc(r,i));!o.next().done;){if(s.length>1e3)return!1;o.value.from==r&&(l=s.length),s.push(y.range(o.value.from,o.value.to))}return e(n.update({selection:y.create(s,l),userEvent:"select.search.matches"})),!0},ie=A((n,{query:e})=>{let{state:t}=n,{from:r,to:i}=t.selection.main;if(t.readOnly)return!1;let s=e.nextMatch(t,r,r);if(!s)return!1;let l=[],o,c,d=[];if(s.from==r&&s.to==i&&(c=t.toText(e.getReplacement(s)),l.push({from:s.from,to:s.to,insert:c}),s=e.nextMatch(t,s.from,s.to),d.push(S.announce.of(t.phrase("replaced match on line $",t.doc.lineAt(r).number)+"."))),s){let h=l.length==0||l[0].from>=s.to?0:s.to-s.from-c.length;o={anchor:s.from-h,head:s.to-h},d.push(Z(n,s))}return n.dispatch({changes:l,selection:o,scrollIntoView:!!o,effects:d,userEvent:"input.replace"}),!0}),_e=A((n,{query:e})=>{if(n.state.readOnly)return!1;let t=e.matchAll(n.state,1e9).map(i=>{let{from:s,to:l}=i;return{from:s,to:l,insert:e.getReplacement(i)}});if(!t.length)return!1;let r=n.state.phrase("replaced $ matches",t.length)+".";return n.dispatch({changes:t,effects:S.announce.of(r),userEvent:"input.replace.all"}),!0});function Y(n){return n.state.facet(B).createPanel(n)}function _(n,e){var t,r,i,s;let l=n.selection.main,o=l.empty||l.to>l.from+100?"":n.sliceDoc(l.from,l.to);if(e&&!o)return e;let c=n.facet(B);return new I({search:((t=e?.literal)!==null&&t!==void 0?t:c.literal)?o:o.replace(/\n/g,"\\n"),caseSensitive:(r=e?.caseSensitive)!==null&&r!==void 0?r:c.caseSensitive,literal:(i=e?.literal)!==null&&i!==void 0?i:c.literal,wholeWord:(s=e?.wholeWord)!==null&&s!==void 0?s:c.wholeWord})}var de=n=>{let e=n.state.field(p,!1);if(e&&e.panel){let t=D(n,Y);if(!t)return!1;let r=t.dom.querySelector("[main-field]");if(r&&r!=n.root.activeElement){let i=_(n.state,e.query.spec);i.valid&&n.dispatch({effects:L.of(i)}),r.focus(),r.select()}}else n.dispatch({effects:[X.of(!0),e?L.of(_(n.state,e.query.spec)):W.appendConfig.of(J)]});return!0},me=n=>{let e=n.state.field(p,!1);if(!e||!e.panel)return!1;let t=D(n,Y);return t&&t.dom.contains(n.root.activeElement)&&n.focus(),n.dispatch({effects:X.of(!1)}),!0},Ue=[{key:"Mod-f",run:de,scope:"editor search-panel"},{key:"F3",run:z,shift:V,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:z,shift:V,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:me,scope:"editor search-panel"},{key:"Mod-Shift-l",run:Ve},{key:"Alt-g",run:ke},{key:"Mod-d",run:Pe,preventDefault:!0}],j=class{constructor(e){this.view=e;let t=this.query=e.state.field(p).query.spec;this.commit=this.commit.bind(this),this.searchField=a("input",{value:t.search,placeholder:u(e,"Find"),"aria-label":u(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=a("input",{value:t.replace,placeholder:u(e,"Replace"),"aria-label":u(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=a("input",{type:"checkbox",name:"case",form:"",checked:t.caseSensitive,onchange:this.commit}),this.reField=a("input",{type:"checkbox",name:"re",form:"",checked:t.regexp,onchange:this.commit}),this.wordField=a("input",{type:"checkbox",name:"word",form:"",checked:t.wholeWord,onchange:this.commit});function r(i,s,l){return a("button",{class:"cm-button",name:i,onclick:s,type:"button"},l)}this.dom=a("div",{onkeydown:i=>this.keydown(i),class:"cm-search"},[this.searchField,r("next",()=>z(e),[u(e,"next")]),r("prev",()=>V(e),[u(e,"previous")]),r("select",()=>ze(e),[u(e,"all")]),a("label",null,[this.caseField,u(e,"match case")]),a("label",null,[this.reField,u(e,"regexp")]),a("label",null,[this.wordField,u(e,"by word")]),...e.state.readOnly?[]:[a("br"),this.replaceField,r("replace",()=>ie(e),[u(e,"replace")]),r("replaceAll",()=>_e(e),[u(e,"replace all")])],a("button",{name:"close",onclick:()=>me(e),"aria-label":u(e,"close"),type:"button"},["\xD7"])])}commit(){let e=new I({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:L.of(e)}))}keydown(e){pe(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?V:z)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),ie(this.view))}update(e){for(let t of e.transactions)for(let r of t.effects)r.is(L)&&!r.value.eq(this.query)&&this.setQuery(r.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(B).top}};function u(n,e){return n.state.phrase(e)}var F=30,w=/[\s\.,:;?!]/;function Z(n,{from:e,to:t}){let r=n.state.doc.lineAt(e),i=n.state.doc.lineAt(t).to,s=Math.max(r.from,e-F),l=Math.min(i,t+F),o=n.state.sliceDoc(s,l);if(s!=r.from){for(let c=0;c<F;c++)if(!w.test(o[c+1])&&w.test(o[c])){o=o.slice(c);break}}if(l!=i){for(let c=o.length-1;c>o.length-F;c--)if(!w.test(o[c-1])&&w.test(o[c])){o=o.slice(0,c);break}}return S.announce.of(`${n.state.phrase("current match")}. ${o} ${n.state.phrase("on line")} ${r.number}.`)}var Be=S.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),J=[p,Me.lowest(Te),Be];export{q as RegExpCursor,M as SearchCursor,I as SearchQuery,me as closeSearchPanel,z as findNext,V as findPrevious,je as getSearchQuery,ke as gotoLine,Ge as highlightSelectionMatches,de as openSearchPanel,_e as replaceAll,ie as replaceNext,Qe as search,Ue as searchKeymap,Je as searchPanelOpen,ze as selectMatches,Pe as selectNextOccurrence,Ve as selectSelectionMatches,L as setSearchQuery};
//# sourceMappingURL=search.mjs.map