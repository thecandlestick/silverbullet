// Ported from js-yaml v3.13.1:
// Copyright 2011-2015 by Vitaly Puzrin. All rights reserved. MIT license.
// https://github.com/nodeca/js-yaml/commit/665aadda42349dcae869f12040d9b10ef18d12da
// Copyright 2018-2023 the Deno authors. All rights reserved. MIT license.
import { Type } from "../type.ts";
import { Buffer } from "../../io/buffer.ts";
// [ 64, 65, 66 ] -> [ padding, CR, LF ]
const BASE64_MAP = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r";
function resolveYamlBinary(data) {
    if (data === null) return false;
    let code;
    let bitlen = 0;
    const max = data.length;
    const map = BASE64_MAP;
    // Convert one by one.
    for(let idx = 0; idx < max; idx++){
        code = map.indexOf(data.charAt(idx));
        // Skip CR/LF
        if (code > 64) continue;
        // Fail on illegal characters
        if (code < 0) return false;
        bitlen += 6;
    }
    // If there are any bits left, source was corrupted
    return bitlen % 8 === 0;
}
function constructYamlBinary(data) {
    // remove CR/LF & padding to simplify scan
    const input = data.replace(/[\r\n=]/g, "");
    const max = input.length;
    const map = BASE64_MAP;
    // Collect by 6*4 bits (3 bytes)
    const result = [];
    let bits = 0;
    for(let idx = 0; idx < max; idx++){
        if (idx % 4 === 0 && idx) {
            result.push(bits >> 16 & 0xff);
            result.push(bits >> 8 & 0xff);
            result.push(bits & 0xff);
        }
        bits = bits << 6 | map.indexOf(input.charAt(idx));
    }
    // Dump tail
    const tailbits = max % 4 * 6;
    if (tailbits === 0) {
        result.push(bits >> 16 & 0xff);
        result.push(bits >> 8 & 0xff);
        result.push(bits & 0xff);
    } else if (tailbits === 18) {
        result.push(bits >> 10 & 0xff);
        result.push(bits >> 2 & 0xff);
    } else if (tailbits === 12) {
        result.push(bits >> 4 & 0xff);
    }
    return new Buffer(new Uint8Array(result));
}
function representYamlBinary(object) {
    const max = object.length;
    const map = BASE64_MAP;
    // Convert every three bytes to 4 ASCII characters.
    let result = "";
    let bits = 0;
    for(let idx = 0; idx < max; idx++){
        if (idx % 3 === 0 && idx) {
            result += map[bits >> 18 & 0x3f];
            result += map[bits >> 12 & 0x3f];
            result += map[bits >> 6 & 0x3f];
            result += map[bits & 0x3f];
        }
        bits = (bits << 8) + object[idx];
    }
    // Dump tail
    const tail = max % 3;
    if (tail === 0) {
        result += map[bits >> 18 & 0x3f];
        result += map[bits >> 12 & 0x3f];
        result += map[bits >> 6 & 0x3f];
        result += map[bits & 0x3f];
    } else if (tail === 2) {
        result += map[bits >> 10 & 0x3f];
        result += map[bits >> 4 & 0x3f];
        result += map[bits << 2 & 0x3f];
        result += map[64];
    } else if (tail === 1) {
        result += map[bits >> 2 & 0x3f];
        result += map[bits << 4 & 0x3f];
        result += map[64];
        result += map[64];
    }
    return result;
}
function isBinary(obj) {
    if (typeof obj?.readSync !== "function") {
        return false;
    }
    const buf = new Buffer();
    try {
        if (0 > buf.readFromSync(obj)) return true;
        return false;
    } catch  {
        return false;
    } finally{
        buf.reset();
    }
}
export const binary = new Type("tag:yaml.org,2002:binary", {
    construct: constructYamlBinary,
    kind: "scalar",
    predicate: isBinary,
    represent: representYamlBinary,
    resolve: resolveYamlBinary
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImh0dHBzOi8vZGVuby5sYW5kL3N0ZEAwLjE4NC4wL3lhbWwvX3R5cGUvYmluYXJ5LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFBvcnRlZCBmcm9tIGpzLXlhbWwgdjMuMTMuMTpcbi8vIENvcHlyaWdodCAyMDExLTIwMTUgYnkgVml0YWx5IFB1enJpbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC4gTUlUIGxpY2Vuc2UuXG4vLyBodHRwczovL2dpdGh1Yi5jb20vbm9kZWNhL2pzLXlhbWwvY29tbWl0LzY2NWFhZGRhNDIzNDlkY2FlODY5ZjEyMDQwZDliMTBlZjE4ZDEyZGFcbi8vIENvcHlyaWdodCAyMDE4LTIwMjMgdGhlIERlbm8gYXV0aG9ycy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4gTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBUeXBlIH0gZnJvbSBcIi4uL3R5cGUudHNcIjtcbmltcG9ydCB0eXBlIHsgQW55IH0gZnJvbSBcIi4uL191dGlscy50c1wiO1xuaW1wb3J0IHsgQnVmZmVyIH0gZnJvbSBcIi4uLy4uL2lvL2J1ZmZlci50c1wiO1xuXG4vLyBbIDY0LCA2NSwgNjYgXSAtPiBbIHBhZGRpbmcsIENSLCBMRiBdXG5jb25zdCBCQVNFNjRfTUFQID1cbiAgXCJBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvPVxcblxcclwiO1xuXG5mdW5jdGlvbiByZXNvbHZlWWFtbEJpbmFyeShkYXRhOiBBbnkpOiBib29sZWFuIHtcbiAgaWYgKGRhdGEgPT09IG51bGwpIHJldHVybiBmYWxzZTtcblxuICBsZXQgY29kZTogbnVtYmVyO1xuICBsZXQgYml0bGVuID0gMDtcbiAgY29uc3QgbWF4ID0gZGF0YS5sZW5ndGg7XG4gIGNvbnN0IG1hcCA9IEJBU0U2NF9NQVA7XG5cbiAgLy8gQ29udmVydCBvbmUgYnkgb25lLlxuICBmb3IgKGxldCBpZHggPSAwOyBpZHggPCBtYXg7IGlkeCsrKSB7XG4gICAgY29kZSA9IG1hcC5pbmRleE9mKGRhdGEuY2hhckF0KGlkeCkpO1xuXG4gICAgLy8gU2tpcCBDUi9MRlxuICAgIGlmIChjb2RlID4gNjQpIGNvbnRpbnVlO1xuXG4gICAgLy8gRmFpbCBvbiBpbGxlZ2FsIGNoYXJhY3RlcnNcbiAgICBpZiAoY29kZSA8IDApIHJldHVybiBmYWxzZTtcblxuICAgIGJpdGxlbiArPSA2O1xuICB9XG5cbiAgLy8gSWYgdGhlcmUgYXJlIGFueSBiaXRzIGxlZnQsIHNvdXJjZSB3YXMgY29ycnVwdGVkXG4gIHJldHVybiBiaXRsZW4gJSA4ID09PSAwO1xufVxuXG5mdW5jdGlvbiBjb25zdHJ1Y3RZYW1sQmluYXJ5KGRhdGE6IHN0cmluZyk6IEJ1ZmZlciB7XG4gIC8vIHJlbW92ZSBDUi9MRiAmIHBhZGRpbmcgdG8gc2ltcGxpZnkgc2NhblxuICBjb25zdCBpbnB1dCA9IGRhdGEucmVwbGFjZSgvW1xcclxcbj1dL2csIFwiXCIpO1xuICBjb25zdCBtYXggPSBpbnB1dC5sZW5ndGg7XG4gIGNvbnN0IG1hcCA9IEJBU0U2NF9NQVA7XG5cbiAgLy8gQ29sbGVjdCBieSA2KjQgYml0cyAoMyBieXRlcylcblxuICBjb25zdCByZXN1bHQgPSBbXTtcbiAgbGV0IGJpdHMgPSAwO1xuICBmb3IgKGxldCBpZHggPSAwOyBpZHggPCBtYXg7IGlkeCsrKSB7XG4gICAgaWYgKGlkeCAlIDQgPT09IDAgJiYgaWR4KSB7XG4gICAgICByZXN1bHQucHVzaCgoYml0cyA+PiAxNikgJiAweGZmKTtcbiAgICAgIHJlc3VsdC5wdXNoKChiaXRzID4+IDgpICYgMHhmZik7XG4gICAgICByZXN1bHQucHVzaChiaXRzICYgMHhmZik7XG4gICAgfVxuXG4gICAgYml0cyA9IChiaXRzIDw8IDYpIHwgbWFwLmluZGV4T2YoaW5wdXQuY2hhckF0KGlkeCkpO1xuICB9XG5cbiAgLy8gRHVtcCB0YWlsXG5cbiAgY29uc3QgdGFpbGJpdHMgPSAobWF4ICUgNCkgKiA2O1xuXG4gIGlmICh0YWlsYml0cyA9PT0gMCkge1xuICAgIHJlc3VsdC5wdXNoKChiaXRzID4+IDE2KSAmIDB4ZmYpO1xuICAgIHJlc3VsdC5wdXNoKChiaXRzID4+IDgpICYgMHhmZik7XG4gICAgcmVzdWx0LnB1c2goYml0cyAmIDB4ZmYpO1xuICB9IGVsc2UgaWYgKHRhaWxiaXRzID09PSAxOCkge1xuICAgIHJlc3VsdC5wdXNoKChiaXRzID4+IDEwKSAmIDB4ZmYpO1xuICAgIHJlc3VsdC5wdXNoKChiaXRzID4+IDIpICYgMHhmZik7XG4gIH0gZWxzZSBpZiAodGFpbGJpdHMgPT09IDEyKSB7XG4gICAgcmVzdWx0LnB1c2goKGJpdHMgPj4gNCkgJiAweGZmKTtcbiAgfVxuXG4gIHJldHVybiBuZXcgQnVmZmVyKG5ldyBVaW50OEFycmF5KHJlc3VsdCkpO1xufVxuXG5mdW5jdGlvbiByZXByZXNlbnRZYW1sQmluYXJ5KG9iamVjdDogVWludDhBcnJheSk6IHN0cmluZyB7XG4gIGNvbnN0IG1heCA9IG9iamVjdC5sZW5ndGg7XG4gIGNvbnN0IG1hcCA9IEJBU0U2NF9NQVA7XG5cbiAgLy8gQ29udmVydCBldmVyeSB0aHJlZSBieXRlcyB0byA0IEFTQ0lJIGNoYXJhY3RlcnMuXG5cbiAgbGV0IHJlc3VsdCA9IFwiXCI7XG4gIGxldCBiaXRzID0gMDtcbiAgZm9yIChsZXQgaWR4ID0gMDsgaWR4IDwgbWF4OyBpZHgrKykge1xuICAgIGlmIChpZHggJSAzID09PSAwICYmIGlkeCkge1xuICAgICAgcmVzdWx0ICs9IG1hcFsoYml0cyA+PiAxOCkgJiAweDNmXTtcbiAgICAgIHJlc3VsdCArPSBtYXBbKGJpdHMgPj4gMTIpICYgMHgzZl07XG4gICAgICByZXN1bHQgKz0gbWFwWyhiaXRzID4+IDYpICYgMHgzZl07XG4gICAgICByZXN1bHQgKz0gbWFwW2JpdHMgJiAweDNmXTtcbiAgICB9XG5cbiAgICBiaXRzID0gKGJpdHMgPDwgOCkgKyBvYmplY3RbaWR4XTtcbiAgfVxuXG4gIC8vIER1bXAgdGFpbFxuXG4gIGNvbnN0IHRhaWwgPSBtYXggJSAzO1xuXG4gIGlmICh0YWlsID09PSAwKSB7XG4gICAgcmVzdWx0ICs9IG1hcFsoYml0cyA+PiAxOCkgJiAweDNmXTtcbiAgICByZXN1bHQgKz0gbWFwWyhiaXRzID4+IDEyKSAmIDB4M2ZdO1xuICAgIHJlc3VsdCArPSBtYXBbKGJpdHMgPj4gNikgJiAweDNmXTtcbiAgICByZXN1bHQgKz0gbWFwW2JpdHMgJiAweDNmXTtcbiAgfSBlbHNlIGlmICh0YWlsID09PSAyKSB7XG4gICAgcmVzdWx0ICs9IG1hcFsoYml0cyA+PiAxMCkgJiAweDNmXTtcbiAgICByZXN1bHQgKz0gbWFwWyhiaXRzID4+IDQpICYgMHgzZl07XG4gICAgcmVzdWx0ICs9IG1hcFsoYml0cyA8PCAyKSAmIDB4M2ZdO1xuICAgIHJlc3VsdCArPSBtYXBbNjRdO1xuICB9IGVsc2UgaWYgKHRhaWwgPT09IDEpIHtcbiAgICByZXN1bHQgKz0gbWFwWyhiaXRzID4+IDIpICYgMHgzZl07XG4gICAgcmVzdWx0ICs9IG1hcFsoYml0cyA8PCA0KSAmIDB4M2ZdO1xuICAgIHJlc3VsdCArPSBtYXBbNjRdO1xuICAgIHJlc3VsdCArPSBtYXBbNjRdO1xuICB9XG5cbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuZnVuY3Rpb24gaXNCaW5hcnkob2JqOiBBbnkpOiBvYmogaXMgQnVmZmVyIHtcbiAgaWYgKHR5cGVvZiBvYmo/LnJlYWRTeW5jICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgY29uc3QgYnVmID0gbmV3IEJ1ZmZlcigpO1xuICB0cnkge1xuICAgIGlmICgwID4gYnVmLnJlYWRGcm9tU3luYyhvYmogYXMgQnVmZmVyKSkgcmV0dXJuIHRydWU7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9IGNhdGNoIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH0gZmluYWxseSB7XG4gICAgYnVmLnJlc2V0KCk7XG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IGJpbmFyeSA9IG5ldyBUeXBlKFwidGFnOnlhbWwub3JnLDIwMDI6YmluYXJ5XCIsIHtcbiAgY29uc3RydWN0OiBjb25zdHJ1Y3RZYW1sQmluYXJ5LFxuICBraW5kOiBcInNjYWxhclwiLFxuICBwcmVkaWNhdGU6IGlzQmluYXJ5LFxuICByZXByZXNlbnQ6IHJlcHJlc2VudFlhbWxCaW5hcnksXG4gIHJlc29sdmU6IHJlc29sdmVZYW1sQmluYXJ5LFxufSk7XG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsK0JBQStCO0FBQy9CLDBFQUEwRTtBQUMxRSxvRkFBb0Y7QUFDcEYsMEVBQTBFO0FBQzFFLFNBQVMsSUFBSSxRQUFRLGFBQWE7QUFFbEMsU0FBUyxNQUFNLFFBQVEscUJBQXFCO0FBRTVDLHdDQUF3QztBQUN4QyxNQUFNLGFBQ0o7QUFFRixTQUFTLGtCQUFrQixJQUFTLEVBQVc7SUFDN0MsSUFBSSxTQUFTLElBQUksRUFBRSxPQUFPLEtBQUs7SUFFL0IsSUFBSTtJQUNKLElBQUksU0FBUztJQUNiLE1BQU0sTUFBTSxLQUFLLE1BQU07SUFDdkIsTUFBTSxNQUFNO0lBRVosc0JBQXNCO0lBQ3RCLElBQUssSUFBSSxNQUFNLEdBQUcsTUFBTSxLQUFLLE1BQU87UUFDbEMsT0FBTyxJQUFJLE9BQU8sQ0FBQyxLQUFLLE1BQU0sQ0FBQztRQUUvQixhQUFhO1FBQ2IsSUFBSSxPQUFPLElBQUksUUFBUztRQUV4Qiw2QkFBNkI7UUFDN0IsSUFBSSxPQUFPLEdBQUcsT0FBTyxLQUFLO1FBRTFCLFVBQVU7SUFDWjtJQUVBLG1EQUFtRDtJQUNuRCxPQUFPLFNBQVMsTUFBTTtBQUN4QjtBQUVBLFNBQVMsb0JBQW9CLElBQVksRUFBVTtJQUNqRCwwQ0FBMEM7SUFDMUMsTUFBTSxRQUFRLEtBQUssT0FBTyxDQUFDLFlBQVk7SUFDdkMsTUFBTSxNQUFNLE1BQU0sTUFBTTtJQUN4QixNQUFNLE1BQU07SUFFWixnQ0FBZ0M7SUFFaEMsTUFBTSxTQUFTLEVBQUU7SUFDakIsSUFBSSxPQUFPO0lBQ1gsSUFBSyxJQUFJLE1BQU0sR0FBRyxNQUFNLEtBQUssTUFBTztRQUNsQyxJQUFJLE1B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